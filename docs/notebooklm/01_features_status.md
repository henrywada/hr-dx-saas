# 機能ステータス（NotebookLM用）

## 完成（DONE）

| 機能名              | 誰が使う    | 画面/URL                        | API/処理          | DB(テーブル)                  | できること                                       | 制約/未対応                                       |
| :------------------ | :---------- | :------------------------------ | :---------------- | :---------------------------- | :----------------------------------------------- | :------------------------------------------------ |
| **認証 (Auth)**     | 全ユーザー  | `/login`, `/signup`             | Supabase Auth     | `auth.users`, `employees`     | メール/パスワードログイン、新規登録              | SNSログイン未対応、パスワードリセットフロー確認中 |
| **ダッシュボード**  | 管理者/社員 | `/dashboard`                    | Server Components | `employees`, `tenants`        | ログインユーザーのロールに応じたウィジェット表示 | ウィジェットの並び替え、カスタマイズ              |
| **サービス管理**    | 開発者      | `/developer/services`           | Server Actions    | `service`, `service_category` | サービスの追加・編集・削除、カテゴリ管理         | サービスアイコンの動的変更（要確認）              |
| **会社管理**        | 開発者      | `/developer/companies`          | Server Actions    | `tenants`, `tenant_service`   | テナント企業の作成、契約サービスの管理           | 契約履歴の詳細表示                                |
| **組織管理 (部署)** | 企業管理者  | `/dashboard/settings/divisions` | Server Actions    | `divisions`                   | 部署の階層構造表示、追加・編集                   | 部署移動時の紐付け履歴管理                        |
| **従業員管理**      | 企業管理者  | `/dashboard/settings/employees` | Server Actions    | `employees`                   | 従業員一覧、招待、部署への所属                   | 一括インポート/エクスポート                       |

## 実装中（IN PROGRESS）

| 機能名                 | 誰が使う   | 画面/URL                 | API/処理          | DB(テーブル)                  | できること                                   | 制約/未対応                                                     |
| :--------------------- | :--------- | :----------------------- | :---------------- | :---------------------------- | :------------------------------------------- | :-------------------------------------------------------------- |
| **従業員ポータル**     | 一般社員   | `/portal`                | Server Components | `employees`, `tenant_service` | 利用可能なサービスのタイル表示               | カードの3D回転アニメーション調整中、エラーハンドリング（404等） |
| **パルスサーベイ**     | 全ユーザー | `/pulse`                 | Server Actions    | _要確認 (pulse_surveys?)_     | アンケート回答、簡易分析                     | 詳細な分析ダッシュボード、定期配信設定                          |
| **ダッシュボード分析** | 管理者     | `/dashboard` (Analytics) | Recharts          | `employees`, _logs?_          | 従業員の活動ログ、サービス利用状況のグラフ化 | データのリアルタイム更新、詳細フィルタリング                    |
| **初期セットアップ**   | 初回管理者 | `/first-login`           | Server Actions    | `teanants`, `employees`       | 初回ログイン時の会社情報・管理者情報登録     | ウィザード形式のUX改善                                          |

## 未着手 / シェルのみ（TODO / SHELL）

> フォルダ構造には存在するが、具体的な実装が確認できていない、または空の可能性がある機能。

| 機能名                  | 誰が使う      | 画面/URL                    | API/処理 | DB(テーブル) | 備考                                      |
| :---------------------- | :------------ | :-------------------------- | :------- | :----------- | :---------------------------------------- |
| **健康経営 (Wellness)** | 産業医/管理者 | `/dashboard/well-being`     | -        | -            | フォルダあり (`dashboard/well-being`)     |
| **リスキリング**        | 社員/管理者   | `/dashboard/reskilling`     | -        | -            | フォルダあり (`dashboard/reskilling`)     |
| **産業医連携 (Doctor)** | 産業医        | `/dashboard/doctor`         | -        | -            | フォルダあり (`dashboard/doctor`)         |
| **アラート管理**        | 管理者        | `/dashboard/manager-alerts` | -        | -            | フォルダあり (`dashboard/manager-alerts`) |

## データモデル / 構造に関する不明点 (UNKNOWN)

1. **パルスサーベイのデータ構造**:
   - `app/pulse` は存在するが、対応する `migrations`
     ファイル（アンケート定義、回答保存用テーブル）の詳細が直近のリストで見当たらない（`schema.sql`にあるか、未作成か要確認）。
2. **ログ/監査ログ**:
   - 「誰がいつ何をしたか」を記録する監査ログテーブルが現状見当たらない。ダッシュボード分析で何を表示するかのデータソースが曖昧。
3. **ロール権限の粒度**:
   - DB上は `app_role` (`check`制約)
     で管理されているが、フロントエンド側での厳密な権限ガード（MiddlewareやLayoutレベル）が全画面で統一されているか再確認が必要。

## 既知の課題

- **技術的負債**: `npx` コマンドの使用禁止（環境依存エラー回避のため `supabase`
  コマンド推奨）。
- **UI/UX**: `canvas` 領域の最大化、モバイル対応（レスポンシブ）のさらなる調整。
- **バグ**: ポータルから特定の遷移で 404 エラーになる現象（調査中/修正済み？）。
- **国際化**: 多言語対応（日/英）の基盤はあるが、全文言への適用状況は未確認。
