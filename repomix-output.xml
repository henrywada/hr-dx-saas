This file is a merged representation of a subset of the codebase, containing files not matching ignore patterns, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of a subset of the repository's contents that is considered the most important context.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching these patterns are excluded: pnpm-lock.yaml, package-lock.json, yarn.lock, **/*.svg
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.github/
  workflows/
    deploy.yml
app/
  auth/
    actions.ts
  dashboard/
    _components/
      dashboard-nav.tsx
    automation/
      page.tsx
    doctor/
      page.tsx
    dx/
      page.tsx
    employees/
      add/
        page.tsx
      actions.ts
      page.tsx
    finance/
      page.tsx
    forecast/
      page.tsx
    marketing/
      page.tsx
    referral/
      page.tsx
    reskilling/
      page.tsx
    security/
      page.tsx
    support/
      page.tsx
    team-building/
      offer-validator/
        page.tsx
      page.tsx
    well-being/
      page.tsx
    workflows/
      _components/
        create-workflow-dialog.tsx
      actions.ts
      page.tsx
    layout.tsx
    page.tsx
  design-system/
    page.tsx
  employees/
    actions.ts
    add-employee-dialog.tsx
    page.tsx
  login/
    page.tsx
  portal/
    page.tsx
  favicon.ico
  globals.css
  layout.tsx
  page.tsx
components/
  ui/
    avatar.tsx
    badge.tsx
    button.tsx
    card.tsx
    dialog.tsx
    dropdown-menu.tsx
    input.tsx
    label.tsx
    select.tsx
    sheet.tsx
    table.tsx
  under-construction.tsx
lib/
  utils.ts
supabase/
  functions/
    api-core/
      .npmrc
      deno.json
      index.ts
  migrations/
    20240101000001_init_schema.sql
    20251230182400_create_initial_schema.sql
    20260106103422_secure_tenancy_rls.sql
    20260108000000_create_workflows_table.sql
  .gitignore
  config.toml
  seed.sql
utils/
  supabase/
    client.ts
    middleware.ts
    server.ts
  roles.ts
.gitignore
components.json
eslint.config.mjs
middleware.ts
next.config.ts
package.json
postcss.config.mjs
README.md
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".github/workflows/deploy.yml">
name: Deploy Functions

on:
  push:
    branches:
      - main
      - master
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    env:
      SUPABASE_ACCESS_TOKEN: ${{ secrets.SUPABASE_ACCESS_TOKEN }}
      SUPABASE_PROJECT_ID: ${{ secrets.SUPABASE_PROJECT_ID }}

    steps:
      - uses: actions/checkout@v3

      - uses: supabase/setup-cli@v1
        with:
          version: latest

      - name: Deploy Edge Functions
        run: supabase functions deploy --no-verify-jwt
</file>

<file path="app/dashboard/automation/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="æ¥­å‹™è‡ªå‹•åŒ–ãƒ»ç”Ÿç”£æ€§å‘ä¸Š" />;
}
</file>

<file path="app/dashboard/doctor/page.tsx">
export default function DoctorDashboard() {
    return (
        <div className="p-8">
            <h1 className="text-2xl font-bold mb-4">ç”£æ¥­åŒ»ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
            <p>ã“ã®ãƒšãƒ¼ã‚¸ã¯ç”£æ¥­åŒ»å°‚ç”¨ã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã§ã™ã€‚ï¼ˆç¾åœ¨é–‹ç™ºä¸­ï¼‰</p>
        </div>
    );
}
</file>

<file path="app/dashboard/dx/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="DXãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–æ¨é€²" />;
}
</file>

<file path="app/dashboard/employees/add/page.tsx">
import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import {
    Select,
    SelectContent,
    SelectItem,
    SelectTrigger,
    SelectValue,
} from "@/components/ui/select";
import { createEmployee } from "../actions";
import Link from "next/link";

export default async function AddEmployeePage() {
    const supabase = await createClient();

    const {
        data: { user },
    } = await supabase.auth.getUser();

    if (!user) {
        return redirect("/login");
    }

    // Get tenant_id to fetch divisions
    const { data: currentEmployee } = await supabase
        .from("employees")
        .select("tenant_id")
        .eq("id", user.id)
        .single();

    if (!currentEmployee?.tenant_id) {
        return <div>Error: No tenant found.</div>;
    }

    // Fetch divisions for the specific tenant
    const { data: divisions } = await supabase
        .from("divisions")
        .select("id, name")
        .eq("tenant_id", currentEmployee.tenant_id);

    return (
        <div className="flex-1 p-8 pt-6">
            <div className="mx-auto max-w-2xl space-y-6 py-10">
                <div className="flex items-center justify-between">
                    <h2 className="text-3xl font-bold tracking-tight">æ–°è¦ç¤¾å“¡ç™»éŒ²</h2>
                </div>

                <Card className="shadow-md rounded-lg">
                    <CardHeader>
                        <CardTitle>ç¤¾å“¡æƒ…å ±</CardTitle>
                    </CardHeader>
                    <CardContent>
                        <form action={createEmployee} className="space-y-6">
                            <div className="space-y-2">
                                <Label htmlFor="name">æ°å <span className="text-red-500">*</span></Label>
                                <Input id="name" name="name" placeholder="John Doe" required />
                            </div>

                            <div className="space-y-2">
                                <Label htmlFor="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span className="text-red-500">*</span></Label>
                                <Input id="email" name="email" type="email" placeholder="john@example.com" required />
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div className="space-y-2">
                                    <Label htmlFor="division">éƒ¨ç½² <span className="text-red-500">*</span></Label>
                                    <Select name="division_id" required>
                                        <SelectTrigger>
                                            <SelectValue placeholder="éƒ¨ç½²ã‚’é¸æŠã—ã¦ãã ã•ã„" />
                                        </SelectTrigger>
                                        <SelectContent>
                                            {divisions?.map((div) => (
                                                <SelectItem key={div.id} value={div.id}>
                                                    {div.name}
                                                </SelectItem>
                                            ))}
                                        </SelectContent>
                                    </Select>
                                </div>

                                <div className="space-y-2">
                                    <Label htmlFor="role">å½¹è· <span className="text-red-500">*</span></Label>
                                    <Select name="role" required defaultValue="member">
                                        <SelectTrigger>
                                            <SelectValue placeholder="å½¹è·ã‚’é¸æŠã—ã¦ãã ã•ã„" />
                                        </SelectTrigger>
                                        <SelectContent>
                                            <SelectItem value="member">Member</SelectItem>
                                            <SelectItem value="boss">Boss</SelectItem>
                                            <SelectItem value="manager">Manager</SelectItem>
                                            <SelectItem value="hr">HR</SelectItem>
                                            <SelectItem value="hr_manager">HR Manager</SelectItem>
                                            <SelectItem value="developer">Developer</SelectItem>
                                            <SelectItem value="company_nurse">Company Nurse</SelectItem>
                                            <SelectItem value="doctor">Doctor</SelectItem>
                                        </SelectContent>
                                    </Select>
                                </div>
                            </div>

                            <div className="flex justify-end gap-4 pt-4">
                                <Button variant="outline" asChild>
                                    <Link href="/dashboard/employees">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</Link>
                                </Button>
                                <Button type="submit">ç™»éŒ²ã™ã‚‹</Button>
                            </div>
                        </form>
                    </CardContent>
                </Card>
            </div>
        </div>
    );
}
</file>

<file path="app/dashboard/employees/actions.ts">
'use server';

import { createClient } from "@/utils/supabase/server";
import { revalidatePath } from "next/cache";
import { redirect } from "next/navigation";

export async function createEmployee(formData: FormData) {
    const supabase = await createClient();

    // 1. Get current user
    const { data: { user } } = await supabase.auth.getUser();
    if (!user) {
        return redirect("/login");
    }

    // 2. Get tenant_id from current user's profile
    const { data: currentEmployee } = await supabase
        .from("employees")
        .select("tenant_id")
        .eq("id", user.id)
        .single();

    if (!currentEmployee?.tenant_id) {
        throw new Error("Current user does not belong to a tenant.");
    }

    // 3. Extract form data
    const name = formData.get("name") as string;
    const email = formData.get("email") as string;
    const division_id = formData.get("division_id") as string;
    const role = formData.get("role") as string;

    // 4. Insert new employee
    // Note: In a real Supabase Auth setup, creating an 'employee' record usually requires
    // a corresponding 'auth.users' record if there is a FK constraint.
    // Since we don't have the Service Role key exposed here to create an Auth user,
    // we will attempt the insert. If the DB requires a valid Auth ID for the 'id' column,
    // this might fail unless we generate a UUID that happens to exist (impossible) 
    // or if the implementation ignores the FK for now (unlikely given previous instructions).
    // However, typical flow is: Invite User (Auth) -> Trigger -> Create Employee.
    // We will proceed with the requested INSERT.

    const { error } = await supabase
        .from("employees")
        .insert({
            tenant_id: currentEmployee.tenant_id,
            name,
            email,
            division_id: division_id || null,
            role,
            is_contracted_person: false,
            // We do NOT set 'id' here, letting Postgres generate it (gen_random_uuid).
            // Warning: This will fail if 'id' references auth.users(id) and the UUID doesn't exist there.
        });

    if (error) {
        console.error("Error creating employee:", error);
        // We might want to return this error to the UI, 
        // but for now we'll throw to be caught by Next.js error boundary or see in logs.
        throw new Error(`Failed to create employee: ${error.message}`);
    }

    revalidatePath("/dashboard/employees");
    redirect("/dashboard/employees");
}
</file>

<file path="app/dashboard/employees/page.tsx">
import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import { Button } from "@/components/ui/button";
import {
    Table,
    TableBody,
    TableCell,
    TableHead,
    TableHeader,
    TableRow,
} from "@/components/ui/table";
import { Plus, Search } from "lucide-react";
import { Input } from "@/components/ui/input";
import { Card, CardContent } from "@/components/ui/card";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";
import { Badge } from "@/components/ui/badge";
import Link from "next/link";
import { getRoleLabel } from "@/utils/roles";

export const dynamic = 'force-dynamic';

export default async function EmployeesPage() {
    const supabase = await createClient();

    const {
        data: { user },
    } = await supabase.auth.getUser();

    if (!user) {
        return redirect("/login");
    }

    // 1. Get the current user's tenant_id and details
    const { data: currentUserEmployee } = await supabase
        .from("employees")
        .select("tenant_id, role, name, tenants(name)")
        .eq("id", user.id)
        .single();

    if (!currentUserEmployee?.tenant_id) {
        // Handle case where user has no tenant (maybe redirect to onboarding or show empty state)
        return <div className="p-8">No tenant information found for this user.</div>;
    }

    // 2. Fetch all employees for this tenant
    const { data: employees } = await supabase
        .from("employees")
        .select("*, divisions(name)")
        .eq("tenant_id", currentUserEmployee.tenant_id)
        .order("name", { ascending: true });

    const employeeName = currentUserEmployee.name || user.email;
    // Handle Supabase relation potentially returning an array
    const tenantData = currentUserEmployee.tenants;
    const tenantName = Array.isArray(tenantData) ? tenantData[0]?.name : (tenantData as any)?.name || "";
    const roleLabel = getRoleLabel(currentUserEmployee.role);

    return (
        <div className="flex-1 space-y-4 p-8 pt-6">
            <div className="flex items-center justify-between space-y-2">
                <div>
                    <h2 className="text-3xl font-bold tracking-tight">å¾“æ¥­å“¡ç®¡ç†</h2>
                    <div className="flex items-center gap-2 text-sm text-muted-foreground mt-1">
                        <span className="font-medium text-foreground">{tenantName}</span>
                        {tenantName && <span>/</span>}
                        <span>{employeeName}</span>
                        <Badge variant="secondary" className="text-xs">
                            {roleLabel}
                        </Badge>
                    </div>
                </div>
                <div className="flex items-center space-x-2">
                    <Button asChild>
                        <Link href="/dashboard/employees/add">
                            <Plus className="mr-2 h-4 w-4" /> ç¤¾å“¡ã‚’è¿½åŠ 
                        </Link>
                    </Button>
                </div>
            </div>

            <Card>
                <CardContent className="p-0">
                    <Table>
                        <TableHeader>
                            <TableRow>
                                <TableHead className="w-[250px]">æ°å</TableHead>
                                <TableHead>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</TableHead>
                                <TableHead>éƒ¨ç½²</TableHead>
                                <TableHead>å½¹è·</TableHead>
                                <TableHead>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</TableHead>
                                <TableHead className="text-right">æ“ä½œ</TableHead>
                            </TableRow>
                        </TableHeader>
                        <TableBody>
                            {employees?.map((employee: any) => (
                                <TableRow key={employee.id}>
                                    <TableCell className="font-medium">
                                        <div className="flex items-center gap-3">
                                            <Avatar className="h-9 w-9">
                                                <AvatarImage src="/placeholder-avatar.jpg" alt={employee.name} />
                                                <AvatarFallback>{employee.name?.slice(0, 2).toUpperCase() || "EM"}</AvatarFallback>
                                            </Avatar>
                                            <div className="flex flex-col">
                                                <span>{employee.name || "Unknown"}</span>
                                            </div>
                                        </div>
                                    </TableCell>
                                    <TableCell>{employee.email}</TableCell>
                                    <TableCell>
                                        {employee.divisions?.name ? (
                                            <Badge variant="outline">{employee.divisions.name}</Badge>
                                        ) : (
                                            <span className="text-muted-foreground">-</span>
                                        )}
                                    </TableCell>
                                    <TableCell>
                                        <Badge variant="secondary" className="capitalize">
                                            {getRoleLabel(employee.role)}
                                        </Badge>
                                    </TableCell>
                                    <TableCell>
                                        <Badge className="bg-green-100 text-green-800 hover:bg-green-100">Active</Badge>
                                    </TableCell>
                                    <TableCell className="text-right">
                                        <Button variant="ghost" size="sm">
                                            Edit
                                        </Button>
                                    </TableCell>
                                </TableRow>
                            ))}
                            {!employees || employees.length === 0 && (
                                <TableRow>
                                    <TableCell colSpan={6} className="h-24 text-center">
                                        No employees found.
                                    </TableCell>
                                </TableRow>
                            )}
                        </TableBody>
                    </Table>
                </CardContent>
            </Card>
        </div>
    );
}
</file>

<file path="app/dashboard/finance/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="è³‡é‡‘ç¹°ã‚Šãƒ»çµŒå–¶æ”¯æ´" />;
}
</file>

<file path="app/dashboard/forecast/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="éœ€è¦äºˆæ¸¬ãƒ»åœ¨åº«ç®¡ç†" />;
}
</file>

<file path="app/dashboard/marketing/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="ç¤¾å†…å‘ã‘ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆ" />;
}
</file>

<file path="app/dashboard/referral/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="äººäº‹ãƒ»æ¡ç”¨æ”¯æ´" />;
}
</file>

<file path="app/dashboard/reskilling/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="äººæè‚²æˆãƒ»ãƒªã‚¹ã‚­ãƒªãƒ³ã‚°" />;
}
</file>

<file path="app/dashboard/security/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒªã‚¹ã‚¯ç®¡ç†" />;
}
</file>

<file path="app/dashboard/support/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="é¡§å®¢å¯¾å¿œãƒ»å–¶æ¥­æ”¯æ´" />;
}
</file>

<file path="app/dashboard/team-building/offer-validator/page.tsx">
"use client";

import { useState } from "react";
import Link from "next/link";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import {
  Card,
  CardContent,
  CardDescription,
  CardFooter,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import { Loader2, ArrowLeft, Search, TrendingUp, CheckCircle2, AlertTriangle, AlertCircle } from "lucide-react";

// ç’°å¢ƒå¤‰æ•°ã€ã¾ãŸã¯ç›´æ¥Webhook URLã‚’æŒ‡å®šï¼ˆæœ¬ç•ªã§ã¯ç’°å¢ƒå¤‰æ•°æ¨å¥¨ï¼‰
// ãƒ†ã‚¹ãƒˆç”¨ã«ç›´æ¥URLã‚’æŒ‡å®šã—ã¾ã™
const N8N_WEBHOOK_URL = "https://wada007.n8n-wsk.com/webhook-test/offer-validator";

export default function OfferValidatorPage() {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [result, setResult] = useState<any>(null);

  const handleDiagnose = async (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setLoading(true);
    setError(null);
    setResult(null);

    const formData = new FormData(e.currentTarget);
    
    // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®åé›†
    const payload = {
      role: formData.get("role"),
      location: formData.get("location"),
      level: formData.get("level"), // Selectã®å€¤ã¯nameå±æ€§ã§å–å¾—ã§ããªã„å ´åˆãŒã‚ã‚‹ãŸã‚æ³¨æ„ãŒå¿…è¦ã ãŒã€Shadcnã®Selectã¯éš ã—inputã‚’æŒãŸãªã„ãŸã‚ã€stateç®¡ç†ã‹åˆ¥é€”å–å¾—ãŒå¿…è¦ã€‚ä»Šå›ã¯ç°¡æ˜“åŒ–ã®ãŸã‚FormDataã‹ã‚‰å–å¾—ã‚’è©¦ã¿ã‚‹ãŒã€Shadcn Selectã®å ´åˆã¯Controlled Componentã«ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã€‚
      // â€»Shadcn UIã®Selectã¯æ¨™æº–ã®formé€ä¿¡ã«å«ã¾ã‚Œãªã„å ´åˆãŒã‚ã‚‹ãŸã‚ã€Stateã§ç®¡ç†ã—ã¾ã™ï¼ˆå¾Œè¿°ã®ä¿®æ­£å‚ç…§ï¼‰
      salary_min: Number(formData.get("salary_min")),
      salary_max: Number(formData.get("salary_max")),
      features: selectedTags, // Stateã‹ã‚‰å–å¾—
    };

    try {
      // n8n Webhookã¸ã®POSTé€ä¿¡
      // â€»URLãŒç©ºã®å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ã™ã‚‹ã‹ã€ãƒ‡ãƒ¢ç”¨ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹
      const targetUrl = N8N_WEBHOOK_URL || "https://primary-production-4321.up.railway.app/webhook/offer-validator-mock"; // ä»®ã®ãƒ¢ãƒƒã‚¯URLï¼ˆè‡ªå‰ã§ç”¨æ„ã™ã‚‹ã‹ã€ã‚¨ãƒ©ãƒ¼ã«ã™ã‚‹ï¼‰

      if (!N8N_WEBHOOK_URL) {
         console.warn("Webhook URL not set. Using Mock Response for demo.");
         // ãƒ‡ãƒ¢ç”¨: å®Ÿéš›ã®Fetchã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™ï¼ˆå‹•ä½œç¢ºèªç”¨ï¼‰
         await new Promise(resolve => setTimeout(resolve, 2500));
         setResult({
            score: "B",
            market_avg_min: 450,
            market_avg_max: 600,
            advice: "æç¤ºé¡ã¯ã‚¨ãƒªã‚¢å¹³å‡ã‚ˆã‚Šã‚„ã‚„ä½ã‚ã§ã™ã€‚éƒ½å†…é€šå‹¤åœã®ç«¶åˆï¼ˆå¹³å‡550ä¸‡ã€œï¼‰ã«äººæãŒæµã‚Œã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚ã€Œãƒªãƒ¢ãƒ¼ãƒˆå¯ã€ãªã©ã®å¾…é‡ã‚’è¿½åŠ ã™ã‚‹ã‹ã€ä¸Šé™ã‚’550ä¸‡ã¾ã§å¼•ãä¸Šã’ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚",
            competitor_trend: "è¿‘éš£ã®ç«¶åˆä»–ç¤¾ã¯ã€Œé€±2ãƒªãƒ¢ãƒ¼ãƒˆã€ã‚’æ¨™æº–åŒ–ã—ã¤ã¤ã‚ã‚Šã¾ã™ã€‚"
         });
         setLoading(false);
         return;
      }

      const response = await fetch(targetUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });

      if (!response.ok) {
        throw new Error(`è¨ºæ–­ã«å¤±æ•—ã—ã¾ã—ãŸ: ${response.statusText}`);
      }

      const data = await response.json();
      setResult(data);

    } catch (err) {
      console.error(err);
      setError("è¨ºæ–­ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãçµŒã£ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
    } finally {
      setLoading(false);
    }
  };

  // Selectã¨Tagsã®ãŸã‚ã®Stateç®¡ç†
  const [level, setLevel] = useState("middle");
  const [selectedTags, setSelectedTags] = useState<string[]>([]);

  const toggleTag = (tag: string) => {
    setSelectedTags(prev => 
      prev.includes(tag) ? prev.filter(t => t !== tag) : [...prev, tag]
    );
  };

  return (
    <div className="mx-auto max-w-4xl space-y-6">
       {/* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}
      <div className="flex items-center gap-2 text-sm text-muted-foreground">
        <Link href="/dashboard/team-building" className="hover:text-primary transition-colors flex items-center gap-1">
          <ArrowLeft className="h-3 w-3" />
          Back to Team Building
        </Link>
      </div>

      <div className="space-y-2">
        <div className="flex items-center gap-2">
            <TrendingUp className="h-6 w-6 text-blue-600" />
            <h1 className="text-3xl font-bold tracking-tight">Offer Validator</h1>
        </div>
        <p className="text-muted-foreground">
          å¸‚å ´ç›¸å ´ã¨ç…§åˆã—ã€ã‚ãªãŸã®ã‚ªãƒ•ã‚¡ãƒ¼ãŒã€Œå‹ã¦ã‚‹æ¡ä»¶ã€ã‹è¨ºæ–­ã—ã¾ã™ã€‚
        </p>
      </div>

      <div className="grid gap-6 lg:grid-cols-[1fr_350px]">
        {/* å·¦å´ï¼šå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  */}
        <Card className="shadow-md h-fit">
          <CardHeader>
            <CardTitle>æ±‚äººæ¡ä»¶ã‚’å…¥åŠ›</CardTitle>
            <CardDescription>
              è¨ºæ–­ã—ãŸã„è·ç¨®ã¨æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
            </CardDescription>
          </CardHeader>
          <form onSubmit={handleDiagnose}>
            <CardContent className="space-y-4">
              <div className="space-y-2">
                <Label htmlFor="role">è·ç¨®å <span className="text-red-500">*</span></Label>
                <Input id="role" name="role" placeholder="ä¾‹: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢" required />
              </div>

              <div className="space-y-2">
                <Label htmlFor="location">å‹¤å‹™åœ° (å¸‚åŒºç”ºæ‘) <span className="text-red-500">*</span></Label>
                <Input id="location" name="location" placeholder="ä¾‹: ç¥å¥ˆå·çœŒåº§é–“å¸‚" required />
              </div>

              <div className="space-y-2">
                <Label htmlFor="level">æƒ³å®šãƒ¬ãƒ™ãƒ«</Label>
                <Select value={level} onValueChange={setLevel} name="level">
                  <SelectTrigger>
                    <SelectValue placeholder="ãƒ¬ãƒ™ãƒ«ã‚’é¸æŠ" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="junior">Junior (å®Ÿå‹™æœªçµŒé¨“ã€œ3å¹´)</SelectItem>
                    <SelectItem value="middle">Middle (3å¹´ã€œãƒªãƒ¼ãƒ€ãƒ¼å€™è£œ)</SelectItem>
                    <SelectItem value="senior">Senior (ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚¯ãƒ©ã‚¹)</SelectItem>
                  </SelectContent>
                </Select>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label htmlFor="salary_min">å¹´åä¸‹é™ (ä¸‡å††)</Label>
                  <Input id="salary_min" name="salary_min" type="number" placeholder="400" required />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="salary_max">å¹´åä¸Šé™ (ä¸‡å††)</Label>
                  <Input id="salary_max" name="salary_max" type="number" placeholder="600" required />
                </div>
              </div>

              <div className="space-y-2">
                <Label>ç‰¹å¾´ãƒ»ã‚¿ã‚° (ä»»æ„)</Label>
                <div className="flex flex-wrap gap-2">
                  {["ãƒªãƒ¢ãƒ¼ãƒˆå¯", "ãƒ•ãƒ¬ãƒƒã‚¯ã‚¹", "å‰¯æ¥­å¯", "é€€è·é‡‘ã‚ã‚Š", "æœªçµŒé¨“å¯"].map((tag) => (
                    <div 
                        key={tag} 
                        onClick={() => toggleTag(tag)}
                        className={`flex items-center space-x-2 rounded-md border p-2 text-sm cursor-pointer transition-colors ${
                            selectedTags.includes(tag) ? "bg-blue-50 border-blue-200 text-blue-700" : "hover:bg-accent"
                        }`}
                    >
                        <div className={`h-4 w-4 rounded border flex items-center justify-center ${
                            selectedTags.includes(tag) ? "bg-primary border-primary" : "border-gray-300"
                        }`}>
                            {selectedTags.includes(tag) && <CheckCircle2 className="h-3 w-3 text-white" />}
                        </div>
                        <label className="cursor-pointer select-none">{tag}</label>
                    </div>
                  ))}
                </div>
              </div>
            </CardContent>
            <CardFooter>
              <Button type="submit" className="w-full" size="lg" disabled={loading}>
                {loading ? (
                  <>
                    <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                    å¸‚å ´ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æä¸­...
                  </>
                ) : (
                  <>
                    <Search className="mr-2 h-4 w-4" />
                    ã“ã®æ¡ä»¶ã§è¨ºæ–­ã™ã‚‹
                  </>
                )}
              </Button>
            </CardFooter>
          </form>
        </Card>

        {/* å³å´ï¼šè¨ºæ–­çµæœã‚¨ãƒªã‚¢ */}
        <div className="space-y-4">
           {/* åˆæœŸè¡¨ç¤ºï¼šãƒ¡ãƒªãƒƒãƒˆã®è¨´æ±‚ */}
           {!result && !loading && !error && (
             <Card className="bg-blue-50/50 border-blue-100 h-full">
               <CardHeader>
                 <CardTitle className="text-lg text-blue-800">Why Validate?</CardTitle>
               </CardHeader>
               <CardContent className="text-sm text-blue-700 space-y-4">
                 <p>æ±‚è·è€…ã®<span className="font-bold">8å‰²</span>ã¯ã€ã¾ãšã€Œçµ¦ä¸ã€ã¨ã€Œå‹¤å‹™åœ°ã€ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚</p>
                 <p>ç›¸å ´ã‚ˆã‚Šä½ã„ã‚ªãƒ•ã‚¡ãƒ¼ã¯ã€ã©ã‚Œã ã‘ç†±ã„ã‚¹ã‚«ã‚¦ãƒˆæ–‡é¢ã‚’é€ã£ã¦ã‚‚é–‹å°ã•ã‚Œã¾ã›ã‚“ã€‚</p>
                 <div className="pt-2 border-t border-blue-200">
                    <p className="font-semibold mb-1">AIãŒãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒã‚¤ãƒ³ãƒˆ:</p>
                    <ul className="list-disc pl-4 space-y-1">
                        <li>è¿‘éš£ã‚¨ãƒªã‚¢ã®å¹³å‡å¹´å</li>
                        <li>ç«¶åˆä»–ç¤¾ã®å¾…é‡ãƒˆãƒ¬ãƒ³ãƒ‰</li>
                        <li>è·ç¨®ã”ã¨ã®éœ€çµ¦ãƒãƒ©ãƒ³ã‚¹</li>
                    </ul>
                 </div>
               </CardContent>
             </Card>
           )}

           {/* ã‚¨ãƒ©ãƒ¼è¡¨ç¤º */}
           {error && (
             <Card className="border-red-200 bg-red-50">
                <CardHeader className="pb-2">
                    <div className="flex items-center gap-2 text-red-700">
                        <AlertCircle className="h-5 w-5" />
                        <CardTitle className="text-base">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</CardTitle>
                    </div>
                </CardHeader>
                <CardContent className="text-sm text-red-600">
                    {error}
                </CardContent>
             </Card>
           )}

           {/* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º */}
           {loading && (
             <Card className="h-full">
                <CardHeader>
                    <div className="h-6 w-1/2 bg-gray-100 rounded animate-pulse"></div>
                </CardHeader>
                <CardContent className="space-y-4">
                    <div className="space-y-2">
                        <div className="h-4 w-full bg-gray-100 rounded animate-pulse"></div>
                        <div className="h-4 w-3/4 bg-gray-100 rounded animate-pulse"></div>
                    </div>
                    <div className="h-32 w-full bg-gray-50 rounded animate-pulse border border-gray-100"></div>
                </CardContent>
             </Card>
           )}

           {/* è¨ºæ–­çµæœè¡¨ç¤º */}
           {result && (
             <Card className={`border-2 shadow-lg animate-in fade-in slide-in-from-bottom-4 duration-500 ${
                 result.score === 'A' ? 'border-green-500 bg-green-50/30' : 
                 result.score === 'B' ? 'border-yellow-400 bg-yellow-50/30' : 
                 'border-red-500 bg-red-50/30'
             }`}>
                <CardHeader className="pb-2">
                    <div className="flex items-center justify-between">
                        <CardTitle>è¨ºæ–­çµæœ</CardTitle>
                        {result.score === 'A' && <CheckCircle2 className="h-8 w-8 text-green-600" />}
                        {result.score === 'B' && <AlertTriangle className="h-8 w-8 text-yellow-600" />}
                        {result.score === 'C' && <AlertTriangle className="h-8 w-8 text-red-600" />}
                    </div>
                    <div className="mt-2">
                        <span className="text-sm text-muted-foreground font-medium">åˆ¤å®šã‚¹ã‚³ã‚¢:</span>
                        <div className="flex items-baseline gap-2 mt-1">
                            <span className={`text-5xl font-extrabold ${
                                result.score === 'A' ? 'text-green-600' : 
                                result.score === 'B' ? 'text-yellow-600' : 'text-red-600'
                            }`}>
                                {result.score}
                            </span>
                            <span className="text-lg font-medium text-muted-foreground">
                                {result.score === 'A' ? 'Competitive' : result.score === 'B' ? 'Warning' : 'Critical'}
                            </span>
                        </div>
                    </div>
                </CardHeader>
                <CardContent className="space-y-5 pt-2">
                    <div className="p-3 bg-white/50 rounded-lg border">
                        <p className="text-xs font-semibold text-muted-foreground uppercase mb-1">ã‚¨ãƒªã‚¢å¹³å‡ç›¸å ´</p>
                        <div className="flex items-baseline gap-1">
                            <span className="text-2xl font-bold text-foreground">
                                {result.market_avg_min}-{result.market_avg_max}
                            </span>
                            <span className="text-sm text-muted-foreground">ä¸‡å††</span>
                        </div>
                    </div>
                    
                    <div className="text-sm leading-relaxed text-foreground/90">
                        <p className="font-bold mb-1 flex items-center gap-1">
                            ğŸ’¡ AI Advice
                        </p>
                        {result.advice}
                    </div>

                     <div className="text-xs text-muted-foreground pt-2 border-t">
                        <span className="font-semibold">Trend:</span> {result.competitor_trend}
                    </div>
                </CardContent>
                <CardFooter>
                    <Button variant="outline" className="w-full bg-white hover:bg-gray-50" onClick={() => setResult(null)}>
                        æ¡ä»¶ã‚’ä¿®æ­£ã—ã¦å†è¨ºæ–­
                    </Button>
                </CardFooter>
             </Card>
           )}
        </div>
      </div>
    </div>
  );
}
</file>

<file path="app/dashboard/well-being/page.tsx">
import UnderConstruction from "@/components/under-construction";

export default function Page() {
    return <UnderConstruction title="çµ„ç¹”ã®å¥åº·åº¦æ¸¬å®šãƒ»æ—©æœŸå¯¾å¿œ" />;
}
</file>

<file path="app/dashboard/workflows/_components/create-workflow-dialog.tsx">
'use client';

import { useState, useTransition } from "react";
import { Button } from "@/components/ui/button";
import {
    Dialog,
    DialogContent,
    DialogDescription,
    DialogFooter,
    DialogHeader,
    DialogTitle,
    DialogTrigger,
} from "@/components/ui/dialog";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
    Select,
    SelectContent,
    SelectItem,
    SelectTrigger,
    SelectValue,
} from "@/components/ui/select";

// Wait, I didn't see textarea.tsx in the list. I'll use standard textarea or Input for now, or check for it.
// Actually standard <textarea> with tailwind classes is fine, or I can use Input for description.
// Let's assume Textarea component might not exist, I'll use Input first or a styled textarea.
// Checking previous list_dir... textarea.tsx was NOT in the list.
// I will use a styled textarea element.

import { createWorkflow } from "../actions";
import { Loader2 } from "lucide-react";

export function CreateWorkflowDialog() {
    const [open, setOpen] = useState(false);
    const [isPending, startTransition] = useTransition();

    async function onSubmit(event: React.FormEvent<HTMLFormElement>) {
        event.preventDefault();
        const formData = new FormData(event.currentTarget);

        startTransition(async () => {
            try {
                await createWorkflow(formData);
                setOpen(false);
            } catch (error) {
                console.error("Failed to create workflow", error);
                alert("Failed to create workflow. Please try again.");
            }
        });
    }

    return (
        <Dialog open={open} onOpenChange={setOpen}>
            <DialogTrigger asChild>
                <Button>ï¼‹ New Workflow</Button>
            </DialogTrigger>
            <DialogContent className="sm:max-w-[425px]">
                <form onSubmit={onSubmit}>
                    <DialogHeader>
                        <DialogTitle>New Workflow</DialogTitle>
                        <DialogDescription>
                            Create a new workflow to automate your HR processes.
                        </DialogDescription>
                    </DialogHeader>
                    <div className="grid gap-4 py-4">
                        <div className="grid grid-cols-4 items-center gap-4">
                            <Label htmlFor="name" className="text-right">
                                Name
                            </Label>
                            <Input
                                id="name"
                                name="name"
                                placeholder="e.g. Onboarding"
                                className="col-span-3"
                                required
                            />
                        </div>
                        <div className="grid grid-cols-4 items-center gap-4">
                            <Label htmlFor="description" className="text-right">
                                Description
                            </Label>
                            <textarea
                                id="description"
                                name="description"
                                className="flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 col-span-3"
                                placeholder="Describe the workflow..."
                            />
                        </div>
                        <div className="grid grid-cols-4 items-center gap-4">
                            <Label htmlFor="status" className="text-right">
                                Status
                            </Label>
                            <div className="col-span-3">
                                <Select name="status" defaultValue="draft">
                                    <SelectTrigger>
                                        <SelectValue placeholder="Select status" />
                                    </SelectTrigger>
                                    <SelectContent>
                                        <SelectItem value="active">Active</SelectItem>
                                        <SelectItem value="draft">Draft</SelectItem>
                                        <SelectItem value="inactive">Inactive</SelectItem>
                                    </SelectContent>
                                </Select>
                            </div>
                        </div>
                    </div>
                    <DialogFooter>
                        <Button type="submit" disabled={isPending}>
                            {isPending && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
                            Create Workflow
                        </Button>
                    </DialogFooter>
                </form>
            </DialogContent>
        </Dialog>
    );
}
</file>

<file path="app/dashboard/workflows/actions.ts">
'use server';

import { createClient } from "@/utils/supabase/server";
import { revalidatePath } from "next/cache";

export async function getWorkflows() {
    const supabase = await createClient();
    const { data: workflows, error } = await supabase
        .from("workflows")
        .select("*")
        .order("created_at", { ascending: false });

    if (error) {
        console.error("Error fetching workflows:", error);
        return [];
    }

    return workflows;
}

export async function createWorkflow(formData: FormData) {
    const supabase = await createClient();
    
    // Auth check (optional but good practice, though RLS handles security)
    const { data: { user } } = await supabase.auth.getUser();
    if (!user) {
        throw new Error("Unauthorized");
    }

    const name = formData.get("name") as string;
    const description = formData.get("description") as string;
    const status = formData.get("status") as string || "draft";

    if (!name) {
        throw new Error("Name is required");
    }

    const { error } = await supabase
        .from("workflows")
        .insert({
            name,
            description,
            status,
        });

    if (error) {
        console.error("Error creating workflow:", error);
        throw new Error(`Failed to create workflow: ${error.message}`);
    }

    revalidatePath("/dashboard/workflows");
}
</file>

<file path="app/dashboard/workflows/page.tsx">
import {
    Card,
    CardContent,
    CardHeader,
    CardTitle,
} from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import {
    Table,
    TableBody,
    TableCell,
    TableHead,
    TableHeader,
    TableRow,
} from "@/components/ui/table";
import {
    DropdownMenu,
    DropdownMenuContent,
    DropdownMenuItem,
    DropdownMenuLabel,
    DropdownMenuSeparator,
    DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import {
    Activity,
    FileText,
    MoreHorizontal,
    Play,
    Zap,
} from "lucide-react";
import { getWorkflows } from "./actions";
import { CreateWorkflowDialog } from "./_components/create-workflow-dialog";


export default async function WorkflowsPage() {
    const workflows = await getWorkflows();

    // çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ (ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è¨ˆç®—ã€ã¾ãŸã¯ã“ã‚Œã‚‰ã¯ã¾ã ãƒ¢ãƒƒã‚¯ã§è‰¯ã„ã‹ç¢ºèªã€‚
    // æŒ‡ç¤ºã§ã¯ã€Œä¸€è¦§è¡¨ç¤ºã®ãƒªã‚¢ãƒ«åŒ–ã€ãŒãƒ¡ã‚¤ãƒ³ã€‚çµ±è¨ˆã¯è§¦ã‚Œã‚‰ã‚Œã¦ã„ãªã„ãŒã€
    // Workflowsã®æ•°ã¯ãƒªã‚¢ãƒ«ã«ã§ãã‚‹ã€‚)
    // I will simplisticly update "Total Workflows" and keep others as mock or remove if potentially confusing.
    // I'll keep them as mock but update Total Workflows count.

    const activeCount = workflows.filter(w => w.status === 'active').length;

    const stats = [
        {
            title: "Total Workflows",
            value: workflows.length.toString(),
            icon: FileText,
            color: "text-blue-500",
        },
        {
            title: "Active Workflows", // Changed "Active Agents" to Workflows to be accurate
            value: activeCount.toString(),
            icon: Zap,
            color: "text-green-500",
        },
        {
            title: "Total Executions",
            value: "1,234", // Mock
            icon: Activity,
            color: "text-orange-500",
        },
    ];

    return (
        <div className="container mx-auto space-y-8">
            {/* Header Area */}
            <div className="flex items-center justify-between">
                <div>
                    <h2 className="text-3xl font-bold tracking-tight">Workflows</h2>
                    <p className="text-muted-foreground">
                        AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨è‡ªå‹•åŒ–ãƒ—ãƒ­ã‚»ã‚¹ã®ç®¡ç†
                    </p>
                </div>
                <CreateWorkflowDialog />
            </div>

            {/* Stats Cards */}
            <div className="grid gap-4 md:grid-cols-3">
                {stats.map((stat) => (
                    <Card key={stat.title}>
                        <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                            <CardTitle className="text-sm font-medium">
                                {stat.title}
                            </CardTitle>
                            <stat.icon className={`h-4 w-4 ${stat.color}`} />
                        </CardHeader>
                        <CardContent>
                            <div className="text-2xl font-bold">{stat.value}</div>
                        </CardContent>
                    </Card>
                ))}
            </div>

            {/* Workflow List Table */}
            <Card>
                {workflows.length === 0 ? (
                    <div className="flex flex-col items-center justify-center py-12 text-center">
                        <FileText className="h-12 w-12 text-muted-foreground/50 mb-4" />
                        <h3 className="text-lg font-semibold">ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“</h3>
                        <p className="text-muted-foreground mb-4">
                            æ–°ã—ã„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã¦ã€æ¥­å‹™ã‚’è‡ªå‹•åŒ–ã—ã¾ã—ã‚‡ã†ã€‚
                        </p>
                        <CreateWorkflowDialog />
                    </div>
                ) : (
                    <Table>
                        <TableHeader>
                            <TableRow>
                                <TableHead>Workflow Name</TableHead>
                                <TableHead>Status</TableHead>
                                <TableHead>Created At</TableHead>
                                <TableHead className="text-right">Actions</TableHead>
                            </TableRow>
                        </TableHeader>
                        <TableBody>
                            {workflows.map((workflow) => (
                                <TableRow key={workflow.id} className="hover:bg-muted/50">
                                    <TableCell>
                                        <div className="font-medium">{workflow.name}</div>
                                        <div className="text-sm text-muted-foreground">
                                            {workflow.description}
                                        </div>
                                    </TableCell>
                                    <TableCell>
                                        <Badge
                                            variant={workflow.status === "active" ? "default" : "secondary"}
                                            className={
                                                workflow.status === "active"
                                                    ? "bg-green-500 hover:bg-green-600"
                                                    : workflow.status === "draft"
                                                        ? "bg-yellow-500 hover:bg-yellow-600 text-white"
                                                        : "bg-gray-500 text-white"
                                            }
                                        >
                                            {workflow.status}
                                        </Badge>
                                    </TableCell>
                                    <TableCell>
                                        {/* Using a simple date format or date-fns if installed. 
                                            I'll use basic JS date for safety if date-fns isn't around, 
                                            but commonly it is in these stacks. 
                                            Actually I saw date-fns in my imports above, wait I added it.
                                            I should check package.json or just use standard Intl.
                                            Safest is standard Intl.DateTimeFormat.
                                        */}
                                        {new Date(workflow.created_at).toLocaleDateString("ja-JP")}
                                    </TableCell>
                                    <TableCell className="text-right">
                                        <div className="flex justify-end gap-2">
                                            <Button variant="ghost" size="icon">
                                                <Play className="h-4 w-4 text-green-600" />
                                            </Button>
                                            <DropdownMenu>
                                                <DropdownMenuTrigger asChild>
                                                    <Button variant="ghost" size="icon">
                                                        <MoreHorizontal className="h-4 w-4" />
                                                        <span className="sr-only">Menu</span>
                                                    </Button>
                                                </DropdownMenuTrigger>
                                                <DropdownMenuContent align="end">
                                                    <DropdownMenuLabel>Actions</DropdownMenuLabel>
                                                    <DropdownMenuItem>Edit</DropdownMenuItem>
                                                    <DropdownMenuItem>View Details</DropdownMenuItem>
                                                    <DropdownMenuSeparator />
                                                    <DropdownMenuItem className="text-red-600">Delete</DropdownMenuItem>
                                                </DropdownMenuContent>
                                            </DropdownMenu>
                                        </div>
                                    </TableCell>
                                </TableRow>
                            ))}
                        </TableBody>
                    </Table>
                )}
            </Card>
        </div>
    );
}
</file>

<file path="app/design-system/page.tsx">
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";

export default function DesignSystemPage() {
    return (
        <div className="min-h-screen bg-background p-10 space-y-10">
            <div className="space-y-4">
                <h1 className="text-3xl font-bold text-foreground">Design System Verification</h1>
                <p className="text-muted-foreground">Clean & Minimal BtoB SaaS Theme</p>
            </div>

            <section className="space-y-4">
                <h2 className="text-2xl font-semibold text-foreground">Buttons</h2>
                <div className="flex flex-wrap gap-4">
                    <Button variant="default">Primary Action</Button>
                    <Button variant="secondary">Secondary Action</Button>
                    <Button variant="outline">Outline Action</Button>
                    <Button variant="ghost">Ghost Action</Button>
                    <Button variant="destructive">Destructive Action</Button>
                </div>
            </section>

            <section className="space-y-4">
                <h2 className="text-2xl font-semibold text-foreground">Cards</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <Card className="shadow-sm">
                        <CardHeader>
                            <CardTitle>Standard Card (Shadow SM)</CardTitle>
                            <CardDescription>Default card style for lists and content.</CardDescription>
                        </CardHeader>
                        <CardContent>
                            <p>This card uses the default shadow-sm token for a subtle depth effect.</p>
                        </CardContent>
                        <CardFooter>
                            <Button className="w-full">Action</Button>
                        </CardFooter>
                    </Card>

                    <Card className="shadow-md">
                        <CardHeader>
                            <CardTitle>Elevated Card (Shadow MD)</CardTitle>
                            <CardDescription>For highlighted content or modals.</CardDescription>
                        </CardHeader>
                        <CardContent>
                            <p>This card uses shadow-md for a more pronounced floating effect.</p>
                        </CardContent>
                        <CardFooter>
                            <Button variant="secondary" className="w-full">Secondary</Button>
                        </CardFooter>
                    </Card>
                </div>
            </section>

            <section className="space-y-4">
                <h2 className="text-2xl font-semibold text-foreground">Color Palette</h2>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div className="space-y-2">
                        <div className="h-20 w-full rounded-md bg-primary shadow-sm flex items-center justify-center text-primary-foreground font-medium">Primary</div>
                        <p className="text-sm font-medium">Orange #F27134</p>
                    </div>
                    <div className="space-y-2">
                        <div className="h-20 w-full rounded-md bg-accent shadow-sm flex items-center justify-center text-accent-foreground font-medium">Accent</div>
                        <p className="text-sm font-medium">Yellow #E1B12C</p>
                    </div>
                    <div className="space-y-2">
                        <div className="h-20 w-full rounded-md bg-muted shadow-sm flex items-center justify-center text-muted-foreground font-medium">Muted</div>
                        <p className="text-sm font-medium">Light Gray</p>
                    </div>
                    <div className="space-y-2">
                        <div className="h-20 w-full rounded-md bg-card border shadow-sm flex items-center justify-center text-card-foreground font-medium">Card Surface</div>
                        <p className="text-sm font-medium">White</p>
                    </div>
                </div>
            </section>
        </div>
    );
}
</file>

<file path="app/employees/actions.ts">
"use server";

import { createClient } from "@/utils/supabase/server";
import { revalidatePath } from "next/cache";

type State = {
  error?: string | null;
  success?: boolean;
};

export async function addEmployee(prevState: State | null, formData: FormData): Promise<State> {
  const supabase = await createClient();

  // 1. èªè¨¼ãƒã‚§ãƒƒã‚¯
  const { data: { user }, error: authError } = await supabase.auth.getUser();
  if (authError || !user) {
    return { error: "èªè¨¼ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚" };
  }

  // 2. ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
  const fullName = formData.get("fullName") as string;
  const email = formData.get("email") as string;
  const role = formData.get("role") as string;
  // Divisionã¯ä»Šå›ã¯ç°¡æ˜“çš„ã«ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦æ‰±ã†ã‹ã€ã‚ã‚‹ã„ã¯æœªå®Ÿè£…ã§ã‚ã‚Œã° null (è¦ä»¶é€šã‚Š)
  // è¦ä»¶: ã€Œéƒ¨ç½² (Division) - â€»ç¾åœ¨ã¯ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã§å¯ã€
  // ãŸã ã— DBã‚¹ã‚­ãƒ¼ãƒçš„ã« divisions ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚‹ãŸã‚ã€ä»Šå›ã¯ã€Œæœªæ‰€å±ã€ã¾ãŸã¯ã€Œãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã•ã‚ŒãŸéƒ¨ç½²åãŒã‚ã‚Œã°ç´ã¥ã‘ã€ãªã©ãŒç†æƒ³ã ãŒ
  // ç°¡æ˜“å®Ÿè£…ã¨ã—ã¦ employees ãƒ†ãƒ¼ãƒ–ãƒ«ã« division_id ãŒã‚ã‚‹å ´åˆã€ãã‚Œã‚’è§£æ±ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
  // ä»Šå›ã¯å–ã‚Šæ€¥ã employees ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¿…é ˆã‚«ãƒ©ãƒ ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŒã€
  // ã‚¨ãƒ©ãƒ¼å›é¿ã®ãŸã‚ã€ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ã®Divisionå…¥åŠ›ã‚’ç„¡è¦–ã—ã€å¾“æ¥­å“¡è¿½åŠ ã®ã¿ã‚’è¡Œã†ã€ã‚ã‚‹ã„ã¯
  // ä»•æ§˜é€šã‚Šã€Œãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã€ã‚’å—ã‘å–ã‚‹ãŒã€DBã«ãã‚ŒãŒãªã‘ã‚Œã°ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚
  // ã“ã“ã§ã¯å®‰å…¨ã®ãŸã‚ã€ä¸€æ—¦ division_id ã¯ null (ã¾ãŸã¯å¿…é ˆã§ãªã‘ã‚Œã°) ã¨ã™ã‚‹ãŒã€
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦ä»¶ã«å¾“ã„ã€Œéƒ¨ç½² (Division)ã€å…¥åŠ›ã‚’å—ã‘å–ã‚‹å®Ÿè£…ã«ã™ã‚‹ã€‚
  // ãŸã ã—ã€ã‚‚ã— division_id (uuid) ãŒå¿…é ˆãªã‚‰ã€ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã§ã¯NGã€‚
  // ã€Œç¾åœ¨ã¯ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã§å¯ã€ã¨ã„ã†è¦ä»¶ã¨æ—¢å­˜DBã‚¹ã‚­ãƒ¼ãƒã®å…¼ã­åˆã„ãŒä¸æ˜ã ãŒã€
  // ãŠãã‚‰ã employees ãƒ†ãƒ¼ãƒ–ãƒ«ã« divisionãªã©ã®ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ ãŒã‚ã‚‹ã‹ã€division_id ãŒ nullable ãªã®ã‹ã€‚
  // å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ `select("*, divisions(name)")` ã—ã¦ã„ãŸã®ã§ã€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚ã‚‹ã€‚
  // ãƒªã‚¹ã‚¯å›é¿: ä»Šå›ã¯ employees ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã® insert ã‚’è¡Œã†ãŒã€division_id ã¯ä¸€æ—¦ç„¡è¦–ã™ã‚‹ã‹ã€
  // ã‚‚ã— employees ãƒ†ãƒ¼ãƒ–ãƒ«ã« division_name ã‚«ãƒ©ãƒ ãŒãªã„å ´åˆã€ã“ã®å…¥åŠ›ã¯ä¿å­˜ã§ããªã„ã€‚
  // ç¢ºå®Ÿãªã®ã¯ã€division_id ã‚’æ¸¡ã™ã“ã¨ã ãŒã€ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ãªã®ã§...
  // ãŠãã‚‰ãã€Œéƒ¨ç½²ã‚’ä½œæˆã—ã¦IDã‚’ç´ä»˜ã‘ã‚‹ã€ã‹ã€Œæ—¢å­˜ã®éƒ¨ç½²ã‹ã‚‰é¸ã¶ã€ãŒæœ¬æ¥ã ãŒã€
  // ã€Œãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã§å¯ã€ã¨ã„ã†è¦ä»¶ã‚’å°Šé‡ã—ã€ã‚‚ã— employees ãƒ†ãƒ¼ãƒ–ãƒ«ã« division ã®ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ ãŒãªã„ãªã‚‰ã€
  // ã“ã®å…¥åŠ›ã¯ä¸€æ—¦ä¿å­˜ã—ãªã„ï¼ˆã‚ã‚‹ã„ã¯ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æ‰±ã†ï¼‰ã€‚
  
  // å®‰å…¨ç­–: ä»Šã¯å¾“æ¥­å“¡ã®åŸºæœ¬æƒ…å ± (åå‰, Email, Role) + TenantID ã‚’ä¿å­˜ã™ã‚‹ã€‚

  if (!fullName || !email || !role) {
      return { error: "å¿…é ˆé …ç›®ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚" };
  }

  // 3. ãƒ†ãƒŠãƒ³ãƒˆIDã®å–å¾— (Secure Lookup)
  // æ“ä½œè€…ãŒæ‰€å±ã™ã‚‹ tenant_id ã‚’å–å¾—ã™ã‚‹
  const { data: operatorEmp, error: opError } = await supabase
    .from("employees")
    .select("tenant_id")
    .eq("id", user.id) // employees.id ã¨ auth.users.id ãŒä¸€è‡´ã—ã¦ã„ã‚‹å‰æ (Supabase Authé€£æºã®åŸºæœ¬)
    .single();

  if (opError || !operatorEmp) {
    return { error: "æ“ä½œãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰€å±æƒ…å ±ãŒå–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚" };
  }

  const tenantId = operatorEmp.tenant_id;

  // 4. ãƒ‡ãƒ¼ã‚¿ä¿å­˜
  const { error: insertError } = await supabase
    .from("employees")
    .insert({
        full_name: fullName, // Schemaè¦ä»¶ã«ã‚ã‚ã›ã‚‹
        email: email,
        role: role,
        tenant_id: tenantId,
        // division_id ã¯ä»Šå›ã¯è¨­å®šã—ãªã„ (ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã‹ã‚‰ã®è§£æ±ºãŒè¤‡é›‘ãªãŸã‚ã€è¦ä»¶ã‚’æº€ãŸã—ã¤ã¤å®‰å…¨ã«å€’ã™)
    });

  if (insertError) {
    console.error("Insert Error:", insertError);
    return { error: "ç¤¾å“¡ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: " + insertError.message };
  }

  revalidatePath("/dashboard/employees"); // ãƒ‘ã‚¹ä¿®æ­£: app/dashboard/employees/page.tsx ãªã®ã§
  // ã‚‚ã— path ãŒ /employees ãªã‚‰ /employeesã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ app/employees/page.tsx ã ã£ãŸã€‚
  // å‰å›ã®ã‚¿ã‚¹ã‚¯ã§ app/employees/page.tsx ã‚’ä½œã£ãŸã®ã§ã€ãƒ‘ã‚¹ã¯ /employees
  revalidatePath("/employees");
  
  return { success: true };
}
</file>

<file path="app/employees/add-employee-dialog.tsx">
"use client";

import { useState, useEffect } from "react";
import { useActionState } from "react";
import { addEmployee } from "./actions";
import { Button } from "@/components/ui/button";
import {
    Dialog,
    DialogContent,
    DialogDescription,
    DialogFooter,
    DialogHeader,
    DialogTitle,
    DialogTrigger,
} from "@/components/ui/dialog";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
    Select,
    SelectContent,
    SelectItem,
    SelectTrigger,
    SelectValue,
} from "@/components/ui/select"; // Selectã‚‚å¿…è¦ (importãƒ‘ã‚¹ç¢ºèª)
import { Plus, Loader2 } from "lucide-react";

// Select ãŒãªã„å ´åˆã¯æ‰‹å‹•ã§ä½œã‚‹ã‹ã€HTML select ã§ä»£ç”¨ã™ã‚‹ã‹ã ãŒã€
// shadcn/ui ã® Select ã‚ã‚‹å‰æã€‚ç¢ºèªã‚¹ãƒ†ãƒƒãƒ—ã§ Select.tsx ãŒã‚ã£ãŸã®ã§OKã€‚

export function AddEmployeeDialog() {
    const [open, setOpen] = useState(false);
    const [state, formAction, isPending] = useActionState(addEmployee, null);

    // æˆåŠŸæ™‚ã«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹
    useEffect(() => {
        if (state?.success) {
            setOpen(false);
        }
    }, [state?.success]);

    return (
        <Dialog open={open} onOpenChange={setOpen}>
            <DialogTrigger asChild>
                <Button>
                    <Plus className="mr-2 h-4 w-4" />
                    ç¤¾å“¡ã‚’è¿½åŠ 
                </Button>
            </DialogTrigger>
            <DialogContent className="sm:max-w-[425px]">
                <DialogHeader>
                    <DialogTitle>ç¤¾å“¡ã‚’è¿½åŠ </DialogTitle>
                    <DialogDescription>
                        æ–°ã—ã„ç¤¾å“¡ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚è¿½åŠ å¾Œã€ä¸€è¦§ã«åæ˜ ã•ã‚Œã¾ã™ã€‚
                    </DialogDescription>
                </DialogHeader>
                <form action={formAction}>
                    <div className="grid gap-4 py-4">
                        <div className="grid grid-cols-4 items-center gap-4">
                            <Label htmlFor="fullName" className="text-right">
                                æ°å
                            </Label>
                            <Input
                                id="fullName"
                                name="fullName"
                                placeholder="å±±ç”° å¤ªéƒ"
                                className="col-span-3"
                                required
                            />
                        </div>
                        <div className="grid grid-cols-4 items-center gap-4">
                            <Label htmlFor="email" className="text-right">
                                Email
                            </Label>
                            <Input
                                id="email"
                                name="email"
                                type="email"
                                placeholder="taro@example.com"
                                className="col-span-3"
                                required
                            />
                        </div>
                        <div className="grid grid-cols-4 items-center gap-4">
                            <Label htmlFor="division" className="text-right">
                                éƒ¨ç½²
                            </Label>
                            <Input
                                id="division"
                                name="division"
                                placeholder="å–¶æ¥­éƒ¨"
                                className="col-span-3"
                            // ä»Šå›ã¯DBä¿å­˜å¯¾è±¡å¤–ã®å¯èƒ½æ€§ãŒã‚ã‚‹ãŒã€UIè¦ä»¶ã«ã¯ã‚ã‚‹ãŸã‚é…ç½®
                            />
                        </div>
                        <div className="grid grid-cols-4 items-center gap-4">
                            <Label htmlFor="role" className="text-right">
                                å½¹è·
                            </Label>
                            <div className="col-span-3">
                                <Select name="role" required defaultValue="employee">
                                    <SelectTrigger>
                                        <SelectValue placeholder="å½¹è·ã‚’é¸æŠ" />
                                    </SelectTrigger>
                                    <SelectContent>
                                        <SelectItem value="employee">ä¸€èˆ¬ç¤¾å“¡ (Employee)</SelectItem>
                                        <SelectItem value="hr_manager">äººäº‹æ‹…å½“ (HR Manager)</SelectItem>
                                        <SelectItem value="boss">ç®¡ç†è€… (Boss)</SelectItem>
                                        <SelectItem value="company_doctor">ç”£æ¥­åŒ» (Company Doctor)</SelectItem>
                                    </SelectContent>
                                </Select>
                            </div>
                        </div>
                    </div>

                    {/* ã‚¨ãƒ©ãƒ¼è¡¨ç¤º */}
                    {state?.error && (
                        <div className="mb-4 p-2 bg-red-50 border border-red-200 rounded text-red-600 text-sm text-center">
                            {state.error}
                        </div>
                    )}

                    <DialogFooter>
                        <Button type="submit" disabled={isPending}>
                            {isPending && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
                            {isPending ? "ä¿å­˜ä¸­..." : "ä¿å­˜"}
                        </Button>
                    </DialogFooter>
                </form>
            </DialogContent>
        </Dialog>
    );
}
</file>

<file path="app/globals.css">
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);
  --radius-3xl: calc(var(--radius) + 12px);
  --radius-4xl: calc(var(--radius) + 16px);
}

:root {
  --radius: 0.625rem;
  
  /* Base */
  --background: hsl(0 0% 100%);
  --foreground: hsl(0 0% 20%);
  
  /* Card */
  --card: hsl(0 0% 100%);
  --card-foreground: hsl(0 0% 20%);
  
  /* Popover */
  --popover: hsl(0 0% 100%);
  --popover-foreground: hsl(0 0% 20%);
  
  /* Primary (Orange #F27134) */
  --primary: hsl(19 88% 57%);
  --primary-foreground: hsl(0 0% 100%);
  
  /* Secondary */
  --secondary: hsl(0 0% 96%);
  --secondary-foreground: hsl(0 0% 20%);
  
  /* Muted */
  --muted: hsl(0 0% 96%);
  --muted-foreground: hsl(0 0% 40%);
  
  /* Accent (Yellow #E1B12C) */
  --accent: hsl(44 76% 53%);
  --accent-foreground: hsl(0 0% 100%);
  
  /* Destructive */
  --destructive: hsl(0 84.2% 60.2%);
  --destructive-foreground: hsl(0 0% 98%);
  
  /* Border & Input */
  --border: hsl(0 0% 90%);
  --input: hsl(0 0% 90%);
  --ring: hsl(19 88% 57%); /* Linking ring to primary */
  
  /* Charts (Preserving structure but adapting if needed, keeping defaults for now as not specified) */
  --chart-1: hsl(12 76% 61%);
  --chart-2: hsl(173 58% 39%);
  --chart-3: hsl(197 37% 24%);
  --chart-4: hsl(43 74% 66%);
  --chart-5: hsl(27 87% 67%);
  
  /* Sidebar (Matching light mode) */
  --sidebar: hsl(0 0% 98%);
  --sidebar-foreground: hsl(240 5.3% 26.1%);
  --sidebar-primary: hsl(240 5.9% 10%);
  --sidebar-primary-foreground: hsl(0 0% 98%);
  --sidebar-accent: hsl(240 4.8% 95.9%);
  --sidebar-accent-foreground: hsl(240 5.9% 10%);
  --sidebar-border: hsl(220 13% 91%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);
}

.dark {
  /* Base - Dark Mode (Inverse of Light) */
  --background: hsl(0 0% 10%);
  --foreground: hsl(0 0% 98%);
  
  /* Card */
  --card: hsl(0 0% 12%);
  --card-foreground: hsl(0 0% 98%);
  
  /* Popover */
  --popover: hsl(0 0% 12%);
  --popover-foreground: hsl(0 0% 98%);
  
  /* Primary */
  --primary: hsl(19 88% 57%);
  --primary-foreground: hsl(0 0% 100%);
  
  /* Secondary */
  --secondary: hsl(0 0% 16%);
  --secondary-foreground: hsl(0 0% 98%);
  
  /* Muted */
  --muted: hsl(0 0% 16%);
  --muted-foreground: hsl(0 0% 64%);
  
  /* Accent */
  --accent: hsl(44 76% 53%);
  --accent-foreground: hsl(0 0% 100%);
  
  /* Destructive */
  --destructive: hsl(0 62.8% 30.6%);
  --destructive-foreground: hsl(0 0% 98%);
  
  /* Border & Input */
  --border: hsl(0 0% 20%);
  --input: hsl(0 0% 20%);
  --ring: hsl(19 88% 57%);
  
  /* Charts */
  --chart-1: hsl(220 70% 50%);
  --chart-2: hsl(160 60% 45%);
  --chart-3: hsl(30 80% 55%);
  --chart-4: hsl(280 65% 60%);
  --chart-5: hsl(340 75% 55%);
  
  /* Sidebar */
  --sidebar: hsl(240 5.9% 10%);
  --sidebar-foreground: hsl(240 4.8% 95.9%);
  --sidebar-primary: hsl(224.3 76.3% 48%);
  --sidebar-primary-foreground: hsl(0 0% 100%);
  --sidebar-accent: hsl(240 3.7% 15.9%);
  --sidebar-accent-foreground: hsl(240 4.8% 95.9%);
  --sidebar-border: hsl(240 3.7% 15.9%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}
</file>

<file path="components/ui/avatar.tsx">
"use client"

import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

function Avatar({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        "relative flex size-8 shrink-0 overflow-hidden rounded-full",
        className
      )}
      {...props}
    />
  )
}

function AvatarImage({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
  return (
    <AvatarPrimitive.Image
      data-slot="avatar-image"
      className={cn("aspect-square size-full", className)}
      {...props}
    />
  )
}

function AvatarFallback({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
  return (
    <AvatarPrimitive.Fallback
      data-slot="avatar-fallback"
      className={cn(
        "bg-muted flex size-full items-center justify-center rounded-full",
        className
      )}
      {...props}
    />
  )
}

export { Avatar, AvatarImage, AvatarFallback }
</file>

<file path="components/ui/badge.tsx">
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
    "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
    {
        variants: {
            variant: {
                default:
                    "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
                secondary:
                    "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
                destructive:
                    "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
                outline: "text-foreground",
            },
        },
        defaultVariants: {
            variant: "default",
        },
    }
)

export interface BadgeProps
    extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> { }

function Badge({ className, variant, ...props }: BadgeProps) {
    return (
        <div className={cn(badgeVariants({ variant }), className)} {...props} />
    )
}

export { Badge, badgeVariants }
</file>

<file path="components/ui/button.tsx">
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
    "inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",
    {
        variants: {
            variant: {
                default: "bg-primary text-primary-foreground hover:bg-primary/90",
                destructive:
                    "bg-destructive text-destructive-foreground hover:bg-destructive/90",
                outline:
                    "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
                secondary:
                    "bg-secondary text-secondary-foreground hover:bg-secondary/80",
                ghost: "hover:bg-accent hover:text-accent-foreground",
                link: "text-primary underline-offset-4 hover:underline",
            },
            size: {
                default: "h-10 px-4 py-2",
                sm: "h-9 rounded-md px-3",
                lg: "h-11 rounded-md px-8",
                icon: "h-10 w-10",
            },
        },
        defaultVariants: {
            variant: "default",
            size: "default",
        },
    }
)

export interface ButtonProps
    extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
    asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
    ({ className, variant, size, asChild = false, ...props }, ref) => {
        const Comp = asChild ? Slot : "button"
        return (
            <Comp
                className={cn(buttonVariants({ variant, size, className }))}
                ref={ref}
                {...props}
            />
        )
    }
)
Button.displayName = "Button"

export { Button, buttonVariants }
</file>

<file path="components/ui/card.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
        className
      )}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("leading-none font-semibold", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}
</file>

<file path="components/ui/dialog.tsx">
"use client"

import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Dialog = DialogPrimitive.Root

const DialogTrigger = DialogPrimitive.Trigger

const DialogPortal = DialogPrimitive.Portal

const DialogClose = DialogPrimitive.Close

const DialogOverlay = React.forwardRef<
    React.ElementRef<typeof DialogPrimitive.Overlay>,
    React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
    <DialogPrimitive.Overlay
        ref={ref}
        className={cn(
            "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
            className
        )}
        {...props}
    />
))
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName

const DialogContent = React.forwardRef<
    React.ElementRef<typeof DialogPrimitive.Content>,
    React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
    <DialogPortal>
        <DialogOverlay />
        <DialogPrimitive.Content
            ref={ref}
            className={cn(
                "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
                className
            )}
            {...props}
        >
            {children}
            <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
                <X className="h-4 w-4" />
                <span className="sr-only">Close</span>
            </DialogPrimitive.Close>
        </DialogPrimitive.Content>
    </DialogPortal>
))
DialogContent.displayName = DialogPrimitive.Content.displayName

const DialogHeader = ({
    className,
    ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
    <div
        className={cn(
            "flex flex-col space-y-1.5 text-center sm:text-left",
            className
        )}
        {...props}
    />
)
DialogHeader.displayName = "DialogHeader"

const DialogFooter = ({
    className,
    ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
    <div
        className={cn(
            "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
            className
        )}
        {...props}
    />
)
DialogFooter.displayName = "DialogFooter"

const DialogTitle = React.forwardRef<
    React.ElementRef<typeof DialogPrimitive.Title>,
    React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
    <DialogPrimitive.Title
        ref={ref}
        className={cn(
            "text-lg font-semibold leading-none tracking-tight",
            className
        )}
        {...props}
    />
))
DialogTitle.displayName = DialogPrimitive.Title.displayName

const DialogDescription = React.forwardRef<
    React.ElementRef<typeof DialogPrimitive.Description>,
    React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
    <DialogPrimitive.Description
        ref={ref}
        className={cn("text-sm text-muted-foreground", className)}
        {...props}
    />
))
DialogDescription.displayName = DialogPrimitive.Description.displayName

export {
    Dialog,
    DialogPortal,
    DialogOverlay,
    DialogClose,
    DialogTrigger,
    DialogContent,
    DialogHeader,
    DialogFooter,
    DialogTitle,
    DialogDescription,
}
</file>

<file path="components/ui/dropdown-menu.tsx">
"use client"

import * as React from "react"
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function DropdownMenu({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
  return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />
}

function DropdownMenuPortal({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
  return (
    <DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
  )
}

function DropdownMenuTrigger({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
  return (
    <DropdownMenuPrimitive.Trigger
      data-slot="dropdown-menu-trigger"
      {...props}
    />
  )
}

function DropdownMenuContent({
  className,
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
  return (
    <DropdownMenuPrimitive.Portal>
      <DropdownMenuPrimitive.Content
        data-slot="dropdown-menu-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",
          className
        )}
        {...props}
      />
    </DropdownMenuPrimitive.Portal>
  )
}

function DropdownMenuGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
  return (
    <DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
  )
}

function DropdownMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
  inset?: boolean
  variant?: "default" | "destructive"
}) {
  return (
    <DropdownMenuPrimitive.Item
      data-slot="dropdown-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
  return (
    <DropdownMenuPrimitive.CheckboxItem
      data-slot="dropdown-menu-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.CheckboxItem>
  )
}

function DropdownMenuRadioGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
  return (
    <DropdownMenuPrimitive.RadioGroup
      data-slot="dropdown-menu-radio-group"
      {...props}
    />
  )
}

function DropdownMenuRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
  return (
    <DropdownMenuPrimitive.RadioItem
      data-slot="dropdown-menu-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.RadioItem>
  )
}

function DropdownMenuLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.Label
      data-slot="dropdown-menu-label"
      data-inset={inset}
      className={cn(
        "px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSeparator({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
  return (
    <DropdownMenuPrimitive.Separator
      data-slot="dropdown-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function DropdownMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="dropdown-menu-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSub({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
  return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />
}

function DropdownMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.SubTrigger
      data-slot="dropdown-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto size-4" />
    </DropdownMenuPrimitive.SubTrigger>
  )
}

function DropdownMenuSubContent({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
  return (
    <DropdownMenuPrimitive.SubContent
      data-slot="dropdown-menu-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className
      )}
      {...props}
    />
  )
}

export {
  DropdownMenu,
  DropdownMenuPortal,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuLabel,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioGroup,
  DropdownMenuRadioItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
}
</file>

<file path="components/ui/input.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

export interface InputProps
    extends React.InputHTMLAttributes<HTMLInputElement> { }

const Input = React.forwardRef<HTMLInputElement, InputProps>(
    ({ className, type, ...props }, ref) => {
        return (
            <input
                type={type}
                className={cn(
                    "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
                    className
                )}
                ref={ref}
                {...props}
            />
        )
    }
)
Input.displayName = "Input"

export { Input }
</file>

<file path="components/ui/label.tsx">
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const labelVariants = cva(
    "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
)

const Label = React.forwardRef<
    React.ElementRef<typeof LabelPrimitive.Root>,
    React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
    <LabelPrimitive.Root
        ref={ref}
        className={cn(labelVariants(), className)}
        {...props}
    />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }
</file>

<file path="components/ui/select.tsx">
"use client"

import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { Check, ChevronDown, ChevronUp } from "lucide-react"

import { cn } from "@/lib/utils"

const Select = SelectPrimitive.Root

const SelectGroup = SelectPrimitive.Group

const SelectValue = SelectPrimitive.Value

const SelectTrigger = React.forwardRef<
    React.ElementRef<typeof SelectPrimitive.Trigger>,
    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
    <SelectPrimitive.Trigger
        ref={ref}
        className={cn(
            "flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
            className
        )}
        {...props}
    >
        {children}
        <SelectPrimitive.Icon asChild>
            <ChevronDown className="h-4 w-4 opacity-50" />
        </SelectPrimitive.Icon>
    </SelectPrimitive.Trigger>
))
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName

const SelectScrollUpButton = React.forwardRef<
    React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
    React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
    <SelectPrimitive.ScrollUpButton
        ref={ref}
        className={cn(
            "flex cursor-default items-center justify-center py-1",
            className
        )}
        {...props}
    >
        <ChevronUp className="h-4 w-4" />
    </SelectPrimitive.ScrollUpButton>
))
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName

const SelectScrollDownButton = React.forwardRef<
    React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
    React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
    <SelectPrimitive.ScrollDownButton
        ref={ref}
        className={cn(
            "flex cursor-default items-center justify-center py-1",
            className
        )}
        {...props}
    >
        <ChevronDown className="h-4 w-4" />
    </SelectPrimitive.ScrollDownButton>
))
SelectScrollDownButton.displayName =
    SelectPrimitive.ScrollDownButton.displayName

const SelectContent = React.forwardRef<
    React.ElementRef<typeof SelectPrimitive.Content>,
    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
    <SelectPrimitive.Portal>
        <SelectPrimitive.Content
            ref={ref}
            className={cn(
                "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
                position === "popper" &&
                "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
                className
            )}
            position={position}
            {...props}
        >
            <SelectScrollUpButton />
            <SelectPrimitive.Viewport
                className={cn(
                    "p-1",
                    position === "popper" &&
                    "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"
                )}
            >
                {children}
            </SelectPrimitive.Viewport>
            <SelectScrollDownButton />
        </SelectPrimitive.Content>
    </SelectPrimitive.Portal>
))
SelectContent.displayName = SelectPrimitive.Content.displayName

const SelectLabel = React.forwardRef<
    React.ElementRef<typeof SelectPrimitive.Label>,
    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
    <SelectPrimitive.Label
        ref={ref}
        className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)}
        {...props}
    />
))
SelectLabel.displayName = SelectPrimitive.Label.displayName

const SelectItem = React.forwardRef<
    React.ElementRef<typeof SelectPrimitive.Item>,
    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
    <SelectPrimitive.Item
        ref={ref}
        className={cn(
            "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
            className
        )}
        {...props}
    >
        <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
            <SelectPrimitive.ItemIndicator>
                <Check className="h-4 w-4" />
            </SelectPrimitive.ItemIndicator>
        </span>

        <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
    </SelectPrimitive.Item>
))
SelectItem.displayName = SelectPrimitive.Item.displayName

const SelectSeparator = React.forwardRef<
    React.ElementRef<typeof SelectPrimitive.Separator>,
    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
    <SelectPrimitive.Separator
        ref={ref}
        className={cn("-mx-1 my-1 h-px bg-muted", className)}
        {...props}
    />
))
SelectSeparator.displayName = SelectPrimitive.Separator.displayName

export {
    Select,
    SelectGroup,
    SelectValue,
    SelectTrigger,
    SelectContent,
    SelectLabel,
    SelectItem,
    SelectSeparator,
    SelectScrollUpButton,
    SelectScrollDownButton,
}
</file>

<file path="components/ui/sheet.tsx">
"use client"

import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
  return <SheetPrimitive.Root data-slot="sheet" {...props} />
}

function SheetTrigger({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
  return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />
}

function SheetClose({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Close>) {
  return <SheetPrimitive.Close data-slot="sheet-close" {...props} />
}

function SheetPortal({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Portal>) {
  return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />
}

function SheetOverlay({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
  return (
    <SheetPrimitive.Overlay
      data-slot="sheet-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function SheetContent({
  className,
  children,
  side = "right",
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
  side?: "top" | "right" | "bottom" | "left"
}) {
  return (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content
        data-slot="sheet-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
          side === "right" &&
            "data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",
          side === "left" &&
            "data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",
          side === "top" &&
            "data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",
          side === "bottom" &&
            "data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",
          className
        )}
        {...props}
      >
        {children}
        <SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none">
          <XIcon className="size-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  )
}

function SheetHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-header"
      className={cn("flex flex-col gap-1.5 p-4", className)}
      {...props}
    />
  )
}

function SheetFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-footer"
      className={cn("mt-auto flex flex-col gap-2 p-4", className)}
      {...props}
    />
  )
}

function SheetTitle({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Title>) {
  return (
    <SheetPrimitive.Title
      data-slot="sheet-title"
      className={cn("text-foreground font-semibold", className)}
      {...props}
    />
  )
}

function SheetDescription({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Description>) {
  return (
    <SheetPrimitive.Description
      data-slot="sheet-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Sheet,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}
</file>

<file path="components/ui/table.tsx">
"use client"

import * as React from "react"

import { cn } from "@/lib/utils"

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div
      data-slot="table-container"
      className="relative w-full overflow-x-auto"
    >
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  )
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  )
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  )
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn(
        "bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
        className
      )}
      {...props}
    />
  )
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn(
        "hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
        className
      )}
      {...props}
    />
  )
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn(
        "text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn(
        "p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  )
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}
</file>

<file path="components/under-construction.tsx">
import { Button } from "@/components/ui/button";
import { Construction } from "lucide-react";
import Link from "next/link";

interface UnderConstructionProps {
    title?: string;
}

export default function UnderConstruction({ title }: UnderConstructionProps) {
    return (
        <div className="flex h-[80vh] w-full flex-col items-center justify-center gap-6 p-4 text-center">
            <div className="rounded-full bg-muted p-6">
                <Construction className="h-12 w-12 text-muted-foreground" />
            </div>
            <div className="space-y-2">
                <h1 className="text-2xl font-bold tracking-tight">
                    {title ? `${title}ã¯é–‹ç™ºä¸­ã§ã™` : "é–‹ç™ºä¸­ã§ã™"}
                </h1>
                <p className="text-muted-foreground">
                    ã“ã®æ©Ÿèƒ½ã¯ç¾åœ¨æº–å‚™ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚
                </p>
            </div>
            <Button asChild>
                <Link href="/dashboard">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹</Link>
            </Button>
        </div>
    );
}
</file>

<file path="lib/utils.ts">
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
</file>

<file path="supabase/functions/api-core/.npmrc">
# Configuration for private npm package dependencies
# For more information on using private registries with Edge Functions, see:
# https://supabase.com/docs/guides/functions/import-maps#importing-from-private-registries
</file>

<file path="supabase/functions/api-core/deno.json">
{
  "imports": {}
}
</file>

<file path="supabase/functions/api-core/index.ts">
// Setup type definitions for built-in Supabase Runtime APIs
import "jsr:@supabase/functions-js/edge-runtime.d.ts"
import { createClient } from 'jsr:@supabase/supabase-js@2'

// å¤‰æ›´ä¾‹
console.log("Hello from Functions! (First Cycle Test)")

Deno.serve(async (req) => {
  // 1. ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆï¼ˆAuthæƒ…å ±ã‚’è‡ªå‹•ç¶™æ‰¿ï¼‰
  const authHeader = req.headers.get('Authorization')!
  const supabase = createClient(
    Deno.env.get('SUPABASE_URL') ?? '',
    Deno.env.get('SUPABASE_ANON_KEY') ?? '',
    { global: { headers: { Authorization: authHeader } } }
  )

  // 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã®ãƒã‚§ãƒƒã‚¯
  const { data: { user }, error: authError } = await supabase.auth.getUser()
  if (authError || !user) {
    return new Response(
      JSON.stringify({ error: 'Unauthorized' }),
      { status: 401, headers: { "Content-Type": "application/json" } }
    )
  }

  // 3. ãƒ†ãƒŠãƒ³ãƒˆIDã®å–å¾—ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ä¸­æ ¸ï¼‰
  // â€» Step 2ã§ä½œã£ãŸDBé–¢æ•° 'get_my_tenant_id' ã‚’å‘¼ã³å‡ºã™
  const { data: tenantId, error: tenantError } = await supabase.rpc('get_my_tenant_id')
  
  if (tenantError || !tenantId) {
    return new Response(
      JSON.stringify({ error: 'Tenant context not found' }),
      { status: 403, headers: { "Content-Type": "application/json" } }
    )
  }

  // --- ã“ã“ã‹ã‚‰ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ (å„ªå…ˆé †ä½Aã®å®Ÿè£…å ´æ‰€) ---
  
  // ä¾‹: å˜ç´”ãªãƒ‡ãƒ¼ã‚¿è¿”å´
  const data = {
    message: `Hello ${user.email}`,
    tenant_id: tenantId,
    timestamp: new Date().toISOString(),
  }

  // ---------------------------------------------------

  return new Response(
    JSON.stringify(data),
    { headers: { "Content-Type": "application/json" } },
  )
})
</file>

<file path="supabase/migrations/20240101000001_init_schema.sql">
-- Create organizations table
create table "public"."organizations" (
  "id" uuid not null default gen_random_uuid(),
  "name" text not null,
  "created_at" timestamp with time zone not null default timezone('utc'::text, now()),
  constraint "organizations_pkey" primary key ("id")
);

-- Create profiles table
create table "public"."profiles" (
  "id" uuid not null,
  "organization_id" uuid,
  "created_at" timestamp with time zone not null default timezone('utc'::text, now()),
  constraint "profiles_pkey" primary key ("id"),
  constraint "profiles_id_fkey" foreign key ("id") references "auth"."users"("id") on delete cascade,
  constraint "profiles_organization_id_fkey" foreign key ("organization_id") references "public"."organizations"("id") on delete set null
);

-- Enable RLS
alter table "public"."organizations" enable row level security;
alter table "public"."profiles" enable row level security;

-- RLS Policies

-- Profiles: Users can view/edit their own profile
create policy "Users can view own profile"
on "public"."profiles"
as permissive
for select
to public
using ((auth.uid() = id));

create policy "Users can update own profile"
on "public"."profiles"
as permissive
for update
to public
using ((auth.uid() = id));

create policy "Users can insert own profile"
on "public"."profiles"
as permissive
for insert
to public
with check ((auth.uid() = id));

-- Organizations: Users can view their own organization
create policy "Users can view own organization"
on "public"."organizations"
as permissive
for select
to public
using ((id in (select profiles.organization_id from profiles where profiles.id = auth.uid())));
</file>

<file path="supabase/migrations/20251230182400_create_initial_schema.sql">
-- Create tenants table
CREATE TABLE tenants (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name TEXT NOT NULL,
    contract_date DATE,
    paid_amount INTEGER DEFAULT 0,
    employee_count INTEGER DEFAULT 0,
    expired_date DATE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

-- Create divisions table
CREATE TABLE divisions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID NOT NULL REFERENCES tenants(id),
    name TEXT NOT NULL
);

-- Create employees table
CREATE TABLE employees (
    id UUID PRIMARY KEY REFERENCES auth.users(id),
    tenant_id UUID NOT NULL REFERENCES tenants(id),
    division_id UUID REFERENCES divisions(id),
    name TEXT,
    email TEXT,
    role TEXT DEFAULT 'member' CHECK (role IN ('member', 'hr', 'hr_manager', 'doctor', 'company_nurse', 'boss', 'developer')),
    is_contracted_person BOOLEAN DEFAULT false,
    contracted_date DATE
);

-- Create services table
CREATE TABLE services (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name TEXT NOT NULL,
    category TEXT,
    description TEXT
);

-- Create tenant_services table
CREATE TABLE tenant_services (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID NOT NULL REFERENCES tenants(id),
    service_id UUID NOT NULL REFERENCES services(id),
    start_date DATE DEFAULT CURRENT_DATE,
    status TEXT DEFAULT 'active'
);

-- Enable RLS on all tables
ALTER TABLE tenants ENABLE ROW LEVEL SECURITY;
ALTER TABLE divisions ENABLE ROW LEVEL SECURITY;
ALTER TABLE employees ENABLE ROW LEVEL SECURITY;
ALTER TABLE services ENABLE ROW LEVEL SECURITY;
ALTER TABLE tenant_services ENABLE ROW LEVEL SECURITY;
</file>

<file path="supabase/migrations/20260106103422_secure_tenancy_rls.sql">
-- ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°: ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ†ãƒŠãƒ³ãƒˆIDã‚’å–å¾—ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç”¨ï¼‰
CREATE OR REPLACE FUNCTION get_my_tenant_id()
RETURNS UUID AS $$
DECLARE
  tenant_id UUID;
BEGIN
  SELECT t.id INTO tenant_id
  FROM tenants t
  INNER JOIN employees e ON e.tenant_id = t.id
  WHERE e.id = auth.uid();
  
  RETURN tenant_id;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- RLSã®æœ‰åŠ¹åŒ–ï¼ˆå¿µã®ç‚ºå†å®Ÿè¡Œï¼‰
ALTER TABLE tenants ENABLE ROW LEVEL SECURITY;
ALTER TABLE divisions ENABLE ROW LEVEL SECURITY;
ALTER TABLE employees ENABLE ROW LEVEL SECURITY;
ALTER TABLE services ENABLE ROW LEVEL SECURITY;
ALTER TABLE tenant_services ENABLE ROW LEVEL SECURITY;

-- â˜…é‡è¦: ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ãƒãƒªã‚·ãƒ¼ï¼ˆä»–ç¤¾ã®ãƒ‡ãƒ¼ã‚¿ã¯çµ¶å¯¾ã«è¦‹ã›ãªã„ï¼‰

-- 1. Employees (ç¤¾å“¡æƒ…å ±)
CREATE POLICY "Users can view employees in their own tenant"
ON employees FOR SELECT
USING (tenant_id = get_my_tenant_id());

CREATE POLICY "Users can update employees in their own tenant"
ON employees FOR UPDATE
USING (tenant_id = get_my_tenant_id());

-- 2. Divisions (éƒ¨ç½²)
CREATE POLICY "Users can view divisions in their own tenant"
ON divisions FOR SELECT
USING (tenant_id = get_my_tenant_id());

-- 3. Tenants (è‡ªç¤¾æƒ…å ±ã®ã¿å‚ç…§å¯)
CREATE POLICY "Users can view own tenant info"
ON tenants FOR SELECT
USING (id = get_my_tenant_id());

-- 4. Tenant Services
CREATE POLICY "Users can view own tenant services"
ON tenant_services FOR SELECT
USING (tenant_id = get_my_tenant_id());
</file>

<file path="supabase/migrations/20260108000000_create_workflows_table.sql">
-- Create workflows table with RLS and tenant isolation
CREATE TABLE workflows (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID NOT NULL DEFAULT get_my_tenant_id() REFERENCES tenants(id),
    name TEXT NOT NULL,
    description TEXT,
    status TEXT NOT NULL DEFAULT 'draft' CHECK (status IN ('active', 'draft', 'inactive')),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

-- Enable RLS
ALTER TABLE workflows ENABLE ROW LEVEL SECURITY;

-- RLS Policies
-- 1. View own tenant's workflows
CREATE POLICY "Users can view workflows in their own tenant"
ON workflows FOR SELECT
USING (tenant_id = get_my_tenant_id());

-- 2. Create workflows for own tenant
-- Note: The DEFAULT get_my_tenant_id() handles the column value, 
-- but we also ensure the user isn't trying to spoof it if they pass it explicitly (though our action won't).
CREATE POLICY "Users can create workflows in their own tenant"
ON workflows FOR INSERT
WITH CHECK (tenant_id = get_my_tenant_id());

-- 3. Update own workflows
CREATE POLICY "Users can update workflows in their own tenant"
ON workflows FOR UPDATE
USING (tenant_id = get_my_tenant_id());

-- 4. Delete own workflows
CREATE POLICY "Users can delete workflows in their own tenant"
ON workflows FOR DELETE
USING (tenant_id = get_my_tenant_id());
</file>

<file path="supabase/.gitignore">
# Supabase
.branches
.temp

# dotenvx
.env.keys
.env.local
.env.*.local
</file>

<file path="supabase/seed.sql">
-- Insert Tenant
INSERT INTO tenants (id, name, created_at)
VALUES ('11111111-1111-1111-1111-111111111111', 'Demo Corp', now())
ON CONFLICT DO NOTHING;

-- Insert Division
INSERT INTO divisions (id, tenant_id, name)
VALUES ('22222222-2222-2222-2222-222222222222', '11111111-1111-1111-1111-111111111111', 'Sales Dept')
ON CONFLICT DO NOTHING;

-- Insert Service
INSERT INTO services (id, name, category, description)
VALUES ('33333333-3333-3333-3333-333333333333', 'HR Guardian', 'Risk Management', 'HR Risk Management Service')
ON CONFLICT DO NOTHING;

-- Insert Tenant Service
INSERT INTO tenant_services (tenant_id, service_id, status)
VALUES (
    '11111111-1111-1111-1111-111111111111',
    '33333333-3333-3333-3333-333333333333',
    'active'
)
ON CONFLICT DO NOTHING;

-- Note: Employees are not seeded here because they require a valid auth.users ID.
-- Please see walkthrough.md for the SQL to link your user.
</file>

<file path="utils/supabase/client.ts">
import { createBrowserClient } from "@supabase/ssr";

export function createClient() {
    return createBrowserClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    );
}
</file>

<file path="utils/supabase/middleware.ts">
import { createServerClient } from "@supabase/ssr";
import { NextResponse, type NextRequest } from "next/server";

export async function updateSession(request: NextRequest) {
    let supabaseResponse = NextResponse.next({
        request,
    });

    const supabase = createServerClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
        {
            cookies: {
                getAll() {
                    return request.cookies.getAll();
                },
                setAll(cookiesToSet) {
                    cookiesToSet.forEach(({ name, value, options }) =>
                        request.cookies.set(name, value)
                    );
                    supabaseResponse = NextResponse.next({
                        request,
                    });
                    cookiesToSet.forEach(({ name, value, options }) =>
                        supabaseResponse.cookies.set(name, value, options)
                    );
                },
            },
        }
    );

    // IMPORTANT: Avoid writing any logic between createServerClient and
    // supabase.auth.getUser(). A simple mistake could make it very hard to debug
    // issues with users being randomly logged out.

    const {
        data: { user },
    } = await supabase.auth.getUser();

    if (
        !user &&
        !request.nextUrl.pathname.startsWith("/login") &&
        !request.nextUrl.pathname.startsWith("/auth")
    ) {
        // no user, potentially respond by redirecting the user to the login page
        const url = request.nextUrl.clone();
        url.pathname = "/login";
        return NextResponse.redirect(url);
    }

    return supabaseResponse;
}
</file>

<file path="utils/supabase/server.ts">
import { createServerClient } from "@supabase/ssr";
import { cookies } from "next/headers";

export async function createClient() {
  const cookieStore = await cookies();

  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll();
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            );
          } catch {
            // The `setAll` method was called from a Server Component.
            // This can be ignored if you have middleware refreshing
            // user sessions.
          }
        },
      },
    }
  );
}
</file>

<file path="utils/roles.ts">
export const ROLES = {
    MEMBER: "member",
    HR: "hr",
    HR_MANAGER: "hr_manager",
    DOCTOR: "doctor",
    COMPANY_NURSE: "company_nurse",
    BOSS: "boss",
    DEVELOPER: "developer",
} as const;

export type Role = (typeof ROLES)[keyof typeof ROLES];

export const ROLE_LABELS: Record<Role, string> = {
    [ROLES.MEMBER]: "å¾“æ¥­å“¡",
    [ROLES.HR]: "äººäº‹",
    [ROLES.HR_MANAGER]: "äººäº‹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼",
    [ROLES.DOCTOR]: "ç”£æ¥­åŒ»",
    [ROLES.COMPANY_NURSE]: "ä¿å¥å¸«",
    [ROLES.BOSS]: "ä¸Šå¸",
    [ROLES.DEVELOPER]: "é–‹ç™ºè€…",
};

export const getRoleLabel = (role: string | null | undefined): string => {
    if (!role) return "";
    // Check if role is a valid Role, otherwise return the original string or empty
    const label = ROLE_LABELS[role as Role];
    return label || role;
};
</file>

<file path=".gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts
</file>

<file path="components.json">
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "app/globals.css",
    "baseColor": "zinc",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "registries": {}
}
</file>

<file path="eslint.config.mjs">
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;
</file>

<file path="middleware.ts">
import { type NextRequest } from "next/server";
import { updateSession } from "@/utils/supabase/middleware";

export async function middleware(request: NextRequest) {
    return await updateSession(request);
}

export const config = {
    matcher: [
        /*
         * Match all request paths except for the ones starting with:
         * - _next/static (static files)
         * - _next/image (image optimization files)
         * - favicon.ico (favicon file)
         * Feel free to modify this pattern to include more paths.
         */
        "/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)",
    ],
};
</file>

<file path="next.config.ts">
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
};

export default nextConfig;
</file>

<file path="package.json">
{
  "name": "saas-app",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "@radix-ui/react-avatar": "^1.1.11",
    "@radix-ui/react-dialog": "^1.1.15",
    "@radix-ui/react-dropdown-menu": "^2.1.16",
    "@radix-ui/react-label": "^2.1.8",
    "@radix-ui/react-select": "^2.2.6",
    "@radix-ui/react-slot": "^1.2.4",
    "@supabase/ssr": "^0.8.0",
    "@supabase/supabase-js": "^2.89.0",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "lucide-react": "^0.562.0",
    "next": "16.1.1",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "stripe": "^20.1.0",
    "tailwind-merge": "^3.4.0"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "16.1.1",
    "tailwindcss": "^4",
    "tw-animate-css": "^1.4.0",
    "typescript": "^5"
  }
}
</file>

<file path="postcss.config.mjs">
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;
</file>

<file path="README.md">
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.
</file>

<file path="app/dashboard/layout.tsx">
import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import { Button } from "@/components/ui/button";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import {
  Bell,
  LogOut,
  Menu,
} from "lucide-react";
import { Russo_One } from "next/font/google";
import Link from "next/link";
import { logout } from "@/app/auth/actions";
import { DashboardNav } from "./_components/dashboard-nav";
import { Sheet, SheetContent, SheetTrigger } from "@/components/ui/sheet";

const logoFont = Russo_One({ weight: "400", subsets: ["latin"] });

export default async function DashboardLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const supabase = await createClient();
  const { data: { user } } = await supabase.auth.getUser();

  if (!user) {
    return redirect("/login");
  }

  // ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ãƒŠãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const { data: employee } = await supabase
    .from("employees")
    .select("*, tenants(*)")
    .eq("id", user.id)
    .single();

  const tenantName = employee?.tenants?.name || "Unknown Organization";
  const employeeName = employee?.name || user.email || "Guest";

  return (
    <div className="flex h-screen w-full bg-gray-50">
      {/* ã‚µã‚¤ãƒ‰ãƒãƒ¼ (PCè¡¨ç¤ºæ™‚ã®ã¿) */}
      <aside className="hidden w-64 flex-col border-r bg-white md:flex">
        <div className="flex h-16 items-center border-b px-6">
          <Link href="/dashboard" className={`${logoFont.className} text-2xl bg-gradient-to-r from-orange-500 to-red-600 bg-clip-text text-transparent drop-shadow-sm`}>
            HR-dx
          </Link>
        </div>
        <DashboardNav className="flex-1" />
      </aside>

      {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */}
      <div className="flex flex-1 flex-col overflow-hidden">
        {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
        <header className="flex h-16 items-center justify-between border-b bg-white px-6 shadow-sm">
          <div className="flex items-center gap-4 md:hidden">
            <Sheet>
              <SheetTrigger asChild>
                <Button variant="ghost" size="icon" className="-ml-2">
                  <Menu className="h-6 w-6" />
                  <span className="sr-only">Open sidebar</span>
                </Button>
              </SheetTrigger>
              <SheetContent side="left" className="p-0 w-64">
                <div className="flex h-16 items-center border-b px-6">
                  <Link href="/dashboard" className={`${logoFont.className} text-2xl bg-gradient-to-r from-orange-500 to-red-600 bg-clip-text text-transparent drop-shadow-sm`}>
                    HR-dx
                  </Link>
                </div>
                {/* Note: In client component for SheetContent we might need to handle closing on click.
                        Common pattern: passing a close function or just relying on link navigation.
                        Since DashboardNav contains Links, navigation will happen but Sheet might stay open?
                        Actually in Next.js App Router, full page reload doesn't happen so Sheet stays open
                        unless we programmatically close it.
                        However, this is a Server Component layout. 
                        To make the Sheet close on navigation, we ideally need a Client Component wrapper.
                        For now, standard usage is acceptable. The user closes it by tapping outside or on X.
                    */}
                <DashboardNav />
              </SheetContent>
            </Sheet>
            <span className={`${logoFont.className} text-2xl bg-gradient-to-r from-orange-500 to-red-600 bg-clip-text text-transparent drop-shadow-sm`}>HR-dx</span>
          </div>
          <div className="flex flex-1 items-center justify-end gap-4">
            <div className="mr-2 hidden flex-col items-end md:flex">
              <span className="text-sm font-medium text-foreground">{employeeName}</span>
              <span className="text-xs text-muted-foreground">{tenantName}</span>
            </div>
            <Button variant="ghost" size="icon" className="relative text-muted-foreground">
              <Bell className="h-5 w-5" />
            </Button>
            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <Button variant="ghost" className="relative h-9 w-9 rounded-full">
                  <Avatar className="h-9 w-9">
                    <AvatarImage src="/placeholder-avatar.jpg" alt="@user" />
                    <AvatarFallback className="bg-primary/10 text-primary">
                      {employeeName.slice(0, 2).toUpperCase()}
                    </AvatarFallback>
                  </Avatar>
                </Button>
              </DropdownMenuTrigger>
              <DropdownMenuContent className="w-56" align="end" forceMount>
                <DropdownMenuLabel className="font-normal">
                  <div className="flex flex-col space-y-1">
                    <p className="text-sm font-medium leading-none">{employeeName}</p>
                    <p className="text-xs leading-none text-muted-foreground">{user.email}</p>
                  </div>
                </DropdownMenuLabel>
                <DropdownMenuSeparator />
                <DropdownMenuItem asChild>
                  <form action={logout} className="w-full cursor-pointer">
                    <button type="submit" className="flex w-full items-center">
                      <LogOut className="mr-2 h-4 w-4" />
                      <span>Log out</span>
                    </button>
                  </form>
                </DropdownMenuItem>
              </DropdownMenuContent>
            </DropdownMenu>
          </div>
        </header>

        {/* ãƒšãƒ¼ã‚¸ã”ã¨ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«å…¥ã‚Šã¾ã™ */}
        <main className="flex-1 overflow-y-auto p-2 md:p-6 bg-gray-50">
          {children}
        </main>
      </div>
    </div>
  );
}
</file>

<file path="app/dashboard/page.tsx">
import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  Layout,
  Plus,
  Users,
  Workflow,
} from "lucide-react";

export default async function DashboardPage() {
  const supabase = await createClient();

  const {
    data: { user },
  } = await supabase.auth.getUser();

  if (!user) {
    return redirect("/login");
  }

  const { data: employee } = await supabase
    .from("employees")
    .select("*, tenants(*)")
    .eq("id", user.id)
    .single();

  const tenantName = employee?.tenants?.name || "Unknown Organization";
  const employeeName = employee?.name || user.email || "Guest";

  // KPIãƒ‡ãƒ¼ã‚¿ã®ãƒ€ãƒŸãƒ¼
  const kpiData = [
    {
      title: "Created Workflows",
      value: "12",
      icon: Layout,
      color: "text-blue-600",
    },
    {
      title: "Monthly Executions",
      value: "145",
      icon: Workflow,
      color: "text-green-600",
    },
    {
      title: "Team Members",
      value: "3",
      icon: Users,
      color: "text-purple-600",
    },
  ];

  // æœ€è¿‘ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã®ãƒ€ãƒŸãƒ¼
  const recentWorkflows = [
    {
      name: "Onboarding Automation",
      status: "Active",
      lastUpdated: "2024-04-01",
    },
    {
      name: "Email Campaign Sequence",
      status: "Draft",
      lastUpdated: "2024-03-28",
    },
    {
      name: "Data Sync: CRM to sheet",
      status: "Active",
      lastUpdated: "2024-03-25",
    },
  ];

  return (
    <div className="mx-auto max-w-6xl space-y-8">
      {/* Welcome Section */}
      <div className="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
        <div>
          <h1 className="text-3xl font-bold tracking-tight text-foreground">
            Hello, {employeeName}
          </h1>
          <p className="text-muted-foreground">
            Here's what's happening with your projects today at {tenantName}.
          </p>
        </div>
        <Button size="lg" className="gap-2 shadow-md">
          <Plus className="h-5 w-5" />
          New Workflow
        </Button>
      </div>

      {/* KPI Cards */}
      <div className="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {kpiData.map((kpi, index) => (
          <Card key={index} className="shadow-sm transition-shadow hover:shadow-md">
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium text-muted-foreground">
                {kpi.title}
              </CardTitle>
              <kpi.icon className={`h-4 w-4 ${kpi.color}`} />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold text-foreground">
                {kpi.value}
              </div>
            </CardContent>
          </Card>
        ))}
      </div>

      {/* Recent Workflows */}
      <div className="space-y-4">
        <div className="flex items-center justify-between">
          <h2 className="text-xl font-semibold tracking-tight text-foreground">
            Recent Workflows
          </h2>
          <Button variant="outline" size="sm">
            View All
          </Button>
        </div>
        <Card className="shadow-sm">
          <Table>
            <TableHeader>
              <TableRow>
                <TableHead>Project Name</TableHead>
                <TableHead>Status</TableHead>
                <TableHead>Last Updated</TableHead>
                <TableHead className="text-right">Actions</TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              {recentWorkflows.map((workflow, index) => (
                <TableRow key={index}>
                  <TableCell className="font-medium text-foreground">
                    {workflow.name}
                  </TableCell>
                  <TableCell>
                    <span
                      className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${
                        workflow.status === "Active"
                          ? "bg-green-100 text-green-800"
                          : "bg-gray-100 text-gray-800"
                      }`}
                    >
                      {workflow.status}
                    </span>
                  </TableCell>
                  <TableCell className="text-muted-foreground">
                    {workflow.lastUpdated}
                  </TableCell>
                  <TableCell className="text-right">
                    <Button variant="ghost" size="sm">
                      ...
                    </Button>
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </Card>
      </div>
    </div>
  );
}
</file>

<file path="app/employees/page.tsx">
import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import {
    Table,
    TableBody,
    TableCell,
    TableHead,
    TableHeader,
    TableRow,
} from "@/components/ui/table";
import { AddEmployeeDialog } from "./add-employee-dialog";

export default async function EmployeesPage() {
    const supabase = await createClient();

    // 1. èªè¨¼ãƒã‚§ãƒƒã‚¯
    const {
        data: { user },
        error: authError,
    } = await supabase.auth.getUser();

    if (authError || !user) {
        redirect("/login");
    }

    // 2. ãƒ‡ãƒ¼ã‚¿å–å¾— (RLSã‚’ä¿¡é ¼ã™ã‚‹ãŸã‚ tenant_id ãƒ•ã‚£ãƒ«ã‚¿ã¯ä¸è¦)
    // divisions ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ left join ã—ã¦éƒ¨ç½²åã‚’å–å¾—
    const { data: employees, error } = await supabase
        .from("employees")
        .select("*, divisions(name)");

    if (error) {
        console.error("Error fetching employees:", error);
        return <div>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</div>;
    }

    return (
        <div className="container mx-auto py-10 px-4 md:px-0">
            <div className="flex items-center justify-between mb-8">
                <h1 className="text-3xl font-bold tracking-tight">ç¤¾å“¡åç°¿</h1>
                <AddEmployeeDialog />
            </div>

            <div className="rounded-md border bg-white shadow-sm overflow-hidden">
                <Table>
                    <TableHeader>
                        <TableRow className="bg-muted/50">
                            <TableHead className="w-[200px]">åå‰</TableHead>
                            <TableHead>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</TableHead>
                            <TableHead>å½¹è· (Role)</TableHead>
                            <TableHead>éƒ¨ç½²</TableHead>
                            <TableHead className="text-right">ç™»éŒ²æ—¥</TableHead>
                        </TableRow>
                    </TableHeader>
                    <TableBody>
                        {!employees || employees.length === 0 ? (
                            <TableRow>
                                <TableCell colSpan={5} className="h-24 text-center text-muted-foreground">
                                    ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚
                                </TableCell>
                            </TableRow>
                        ) : (
                            employees.map((employee: any) => (
                                <TableRow key={employee.id}>
                                    <TableCell className="font-medium">{employee.full_name}</TableCell>
                                    <TableCell>{employee.email}</TableCell>
                                    <TableCell>
                                        {/* Roleã®è¡¨ç¤ºç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ãŒã‚ã‚Œã°ä½¿ç”¨æ¨å¥¨ã ãŒã€ä»Šå›ã¯ç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º */}
                                        <span className="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80">
                                            {employee.role}
                                        </span>
                                    </TableCell>
                                    <TableCell>
                                        {/* é…åˆ—ã¾ãŸã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦è¿”ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚å®‰å…¨ã«ã‚¢ã‚¯ã‚»ã‚¹ */}
                                        {employee.divisions?.name || "-"}
                                    </TableCell>
                                    <TableCell className="text-right tabular-nums text-muted-foreground">
                                        {new Date(employee.created_at).toLocaleDateString("ja-JP")}
                                    </TableCell>
                                </TableRow>
                            ))
                        )}
                    </TableBody>
                </Table>
            </div>
        </div>
    );
}
</file>

<file path="supabase/config.toml">
# For detailed configuration reference documentation, visit:
# https://supabase.com/docs/guides/local-development/cli/config
# A string used to distinguish different Supabase projects on the same host. Defaults to the
# working directory name when running `supabase init`.
project_id = "saas-app"

[api]
enabled = true
# Port to use for the API URL.
port = 54321
# Schemas to expose in your API. Tables, views and stored procedures in this schema will get API
# endpoints. `public` and `graphql_public` schemas are included by default.
schemas = ["public", "graphql_public"]
# Extra schemas to add to the search_path of every request.
extra_search_path = ["public", "extensions"]
# The maximum number of rows returns from a view, table, or stored procedure. Limits payload size
# for accidental or malicious requests.
max_rows = 1000

[api.tls]
# Enable HTTPS endpoints locally using a self-signed certificate.
enabled = false
# Paths to self-signed certificate pair.
# cert_path = "../certs/my-cert.pem"
# key_path = "../certs/my-key.pem"

[db]
# Port to use for the local database URL.
port = 54322
# Port used by db diff command to initialize the shadow database.
shadow_port = 54320
# The database major version to use. This has to be the same as your remote database's. Run `SHOW
# server_version;` on the remote database to check.
major_version = 17

[db.pooler]
enabled = false
# Port to use for the local connection pooler.
port = 54329
# Specifies when a server connection can be reused by other clients.
# Configure one of the supported pooler modes: `transaction`, `session`.
pool_mode = "transaction"
# How many server connections to allow per user/database pair.
default_pool_size = 20
# Maximum number of client connections allowed.
max_client_conn = 100

# [db.vault]
# secret_key = "env(SECRET_VALUE)"

[db.migrations]
# If disabled, migrations will be skipped during a db push or reset.
enabled = true
# Specifies an ordered list of schema files that describe your database.
# Supports glob patterns relative to supabase directory: "./schemas/*.sql"
schema_paths = []

[db.seed]
# If enabled, seeds the database after migrations during a db reset.
enabled = true
# Specifies an ordered list of seed files to load during db reset.
# Supports glob patterns relative to supabase directory: "./seeds/*.sql"
sql_paths = ["./seed.sql"]

[db.network_restrictions]
# Enable management of network restrictions.
enabled = false
# List of IPv4 CIDR blocks allowed to connect to the database.
# Defaults to allow all IPv4 connections. Set empty array to block all IPs.
allowed_cidrs = ["0.0.0.0/0"]
# List of IPv6 CIDR blocks allowed to connect to the database.
# Defaults to allow all IPv6 connections. Set empty array to block all IPs.
allowed_cidrs_v6 = ["::/0"]

[realtime]
enabled = true
# Bind realtime via either IPv4 or IPv6. (default: IPv4)
# ip_version = "IPv6"
# The maximum length in bytes of HTTP request headers. (default: 4096)
# max_header_length = 4096

[studio]
enabled = true
# Port to use for Supabase Studio.
port = 54323
# External URL of the API server that frontend connects to.
api_url = "http://127.0.0.1"
# OpenAI API Key to use for Supabase AI in the Supabase Studio.
openai_api_key = "env(OPENAI_API_KEY)"

# Email testing server. Emails sent with the local dev setup are not actually sent - rather, they
# are monitored, and you can view the emails that would have been sent from the web interface.
[inbucket]
enabled = true
# Port to use for the email testing server web interface.
port = 54324
# Uncomment to expose additional ports for testing user applications that send emails.
# smtp_port = 54325
# pop3_port = 54326
# admin_email = "admin@email.com"
# sender_name = "Admin"

[storage]
enabled = true
# The maximum file size allowed (e.g. "5MB", "500KB").
file_size_limit = "50MiB"

# Uncomment to configure local storage buckets
# [storage.buckets.images]
# public = false
# file_size_limit = "50MiB"
# allowed_mime_types = ["image/png", "image/jpeg"]
# objects_path = "./images"

# Allow connections via S3 compatible clients
[storage.s3_protocol]
enabled = true

# Image transformation API is available to Supabase Pro plan.
# [storage.image_transformation]
# enabled = true

# Store analytical data in S3 for running ETL jobs over Iceberg Catalog
# This feature is only available on the hosted platform.
[storage.analytics]
enabled = false
max_namespaces = 5
max_tables = 10
max_catalogs = 2

# Analytics Buckets is available to Supabase Pro plan.
# [storage.analytics.buckets.my-warehouse]

# Store vector embeddings in S3 for large and durable datasets
# This feature is only available on the hosted platform.
[storage.vector]
enabled = false
max_buckets = 10
max_indexes = 5

# Vector Buckets is available to Supabase Pro plan.
# [storage.vector.buckets.documents-openai]

[auth]
enabled = true
# The base URL of your website. Used as an allow-list for redirects and for constructing URLs used
# in emails.
site_url = "http://127.0.0.1:3000"
# A list of *exact* URLs that auth providers are permitted to redirect to post authentication.
additional_redirect_urls = ["https://127.0.0.1:3000"]
# How long tokens are valid for, in seconds. Defaults to 3600 (1 hour), maximum 604,800 (1 week).
jwt_expiry = 3600
# JWT issuer URL. If not set, defaults to the local API URL (http://127.0.0.1:<port>/auth/v1).
# jwt_issuer = ""
# Path to JWT signing key. DO NOT commit your signing keys file to git.
# signing_keys_path = "./signing_keys.json"
# If disabled, the refresh token will never expire.
enable_refresh_token_rotation = true
# Allows refresh tokens to be reused after expiry, up to the specified interval in seconds.
# Requires enable_refresh_token_rotation = true.
refresh_token_reuse_interval = 10
# Allow/disallow new user signups to your project.
enable_signup = true
# Allow/disallow anonymous sign-ins to your project.
enable_anonymous_sign_ins = false
# Allow/disallow testing manual linking of accounts
enable_manual_linking = false
# Passwords shorter than this value will be rejected as weak. Minimum 6, recommended 8 or more.
minimum_password_length = 6
# Passwords that do not meet the following requirements will be rejected as weak. Supported values
# are: `letters_digits`, `lower_upper_letters_digits`, `lower_upper_letters_digits_symbols`
password_requirements = ""

[auth.rate_limit]
# Number of emails that can be sent per hour. Requires auth.email.smtp to be enabled.
email_sent = 2
# Number of SMS messages that can be sent per hour. Requires auth.sms to be enabled.
sms_sent = 30
# Number of anonymous sign-ins that can be made per hour per IP address. Requires enable_anonymous_sign_ins = true.
anonymous_users = 30
# Number of sessions that can be refreshed in a 5 minute interval per IP address.
token_refresh = 150
# Number of sign up and sign-in requests that can be made in a 5 minute interval per IP address (excludes anonymous users).
sign_in_sign_ups = 30
# Number of OTP / Magic link verifications that can be made in a 5 minute interval per IP address.
token_verifications = 30
# Number of Web3 logins that can be made in a 5 minute interval per IP address.
web3 = 30

# Configure one of the supported captcha providers: `hcaptcha`, `turnstile`.
# [auth.captcha]
# enabled = true
# provider = "hcaptcha"
# secret = ""

[auth.email]
# Allow/disallow new user signups via email to your project.
enable_signup = true
# If enabled, a user will be required to confirm any email change on both the old, and new email
# addresses. If disabled, only the new email is required to confirm.
double_confirm_changes = true
# If enabled, users need to confirm their email address before signing in.
enable_confirmations = false
# If enabled, users will need to reauthenticate or have logged in recently to change their password.
secure_password_change = false
# Controls the minimum amount of time that must pass before sending another signup confirmation or password reset email.
max_frequency = "1s"
# Number of characters used in the email OTP.
otp_length = 6
# Number of seconds before the email OTP expires (defaults to 1 hour).
otp_expiry = 3600

# Use a production-ready SMTP server
# [auth.email.smtp]
# enabled = true
# host = "smtp.sendgrid.net"
# port = 587
# user = "apikey"
# pass = "env(SENDGRID_API_KEY)"
# admin_email = "admin@email.com"
# sender_name = "Admin"

# Uncomment to customize email template
# [auth.email.template.invite]
# subject = "You have been invited"
# content_path = "./supabase/templates/invite.html"

# Uncomment to customize notification email template
# [auth.email.notification.password_changed]
# enabled = true
# subject = "Your password has been changed"
# content_path = "./templates/password_changed_notification.html"

[auth.sms]
# Allow/disallow new user signups via SMS to your project.
enable_signup = false
# If enabled, users need to confirm their phone number before signing in.
enable_confirmations = false
# Template for sending OTP to users
template = "Your code is {{ .Code }}"
# Controls the minimum amount of time that must pass before sending another sms otp.
max_frequency = "5s"

# Use pre-defined map of phone number to OTP for testing.
# [auth.sms.test_otp]
# 4152127777 = "123456"

# Configure logged in session timeouts.
# [auth.sessions]
# Force log out after the specified duration.
# timebox = "24h"
# Force log out if the user has been inactive longer than the specified duration.
# inactivity_timeout = "8h"

# This hook runs before a new user is created and allows developers to reject the request based on the incoming user object.
# [auth.hook.before_user_created]
# enabled = true
# uri = "pg-functions://postgres/auth/before-user-created-hook"

# This hook runs before a token is issued and allows you to add additional claims based on the authentication method used.
# [auth.hook.custom_access_token]
# enabled = true
# uri = "pg-functions://<database>/<schema>/<hook_name>"

# Configure one of the supported SMS providers: `twilio`, `twilio_verify`, `messagebird`, `textlocal`, `vonage`.
[auth.sms.twilio]
enabled = false
account_sid = ""
message_service_sid = ""
# DO NOT commit your Twilio auth token to git. Use environment variable substitution instead:
auth_token = "env(SUPABASE_AUTH_SMS_TWILIO_AUTH_TOKEN)"

# Multi-factor-authentication is available to Supabase Pro plan.
[auth.mfa]
# Control how many MFA factors can be enrolled at once per user.
max_enrolled_factors = 10

# Control MFA via App Authenticator (TOTP)
[auth.mfa.totp]
enroll_enabled = false
verify_enabled = false

# Configure MFA via Phone Messaging
[auth.mfa.phone]
enroll_enabled = false
verify_enabled = false
otp_length = 6
template = "Your code is {{ .Code }}"
max_frequency = "5s"

# Configure MFA via WebAuthn
# [auth.mfa.web_authn]
# enroll_enabled = true
# verify_enabled = true

# Use an external OAuth provider. The full list of providers are: `apple`, `azure`, `bitbucket`,
# `discord`, `facebook`, `github`, `gitlab`, `google`, `keycloak`, `linkedin_oidc`, `notion`, `twitch`,
# `twitter`, `x`, `slack`, `spotify`, `workos`, `zoom`.
[auth.external.apple]
enabled = false
client_id = ""
# DO NOT commit your OAuth provider secret to git. Use environment variable substitution instead:
secret = "env(SUPABASE_AUTH_EXTERNAL_APPLE_SECRET)"
# Overrides the default auth redirectUrl.
redirect_uri = ""
# Overrides the default auth provider URL. Used to support self-hosted gitlab, single-tenant Azure,
# or any other third-party OIDC providers.
url = ""
# If enabled, the nonce check will be skipped. Required for local sign in with Google auth.
skip_nonce_check = false
# If enabled, it will allow the user to successfully authenticate when the provider does not return an email address.
email_optional = false

# Allow Solana wallet holders to sign in to your project via the Sign in with Solana (SIWS, EIP-4361) standard.
# You can configure "web3" rate limit in the [auth.rate_limit] section and set up [auth.captcha] if self-hosting.
[auth.web3.solana]
enabled = false

# Use Firebase Auth as a third-party provider alongside Supabase Auth.
[auth.third_party.firebase]
enabled = false
# project_id = "my-firebase-project"

# Use Auth0 as a third-party provider alongside Supabase Auth.
[auth.third_party.auth0]
enabled = false
# tenant = "my-auth0-tenant"
# tenant_region = "us"

# Use AWS Cognito (Amplify) as a third-party provider alongside Supabase Auth.
[auth.third_party.aws_cognito]
enabled = false
# user_pool_id = "my-user-pool-id"
# user_pool_region = "us-east-1"

# Use Clerk as a third-party provider alongside Supabase Auth.
[auth.third_party.clerk]
enabled = false
# Obtain from https://clerk.com/setup/supabase
# domain = "example.clerk.accounts.dev"

# OAuth server configuration
[auth.oauth_server]
# Enable OAuth server functionality
enabled = false
# Path for OAuth consent flow UI
authorization_url_path = "/oauth/consent"
# Allow dynamic client registration
allow_dynamic_registration = false

[edge_runtime]
enabled = true
# Supported request policies: `oneshot`, `per_worker`.
# `per_worker` (default) â€” enables hot reload during local development.
# `oneshot` â€” fallback mode if hot reload causes issues (e.g. in large repos or with symlinks).
policy = "per_worker"
# Port to attach the Chrome inspector for debugging edge functions.
inspector_port = 8083
# The Deno major version to use.
deno_version = 2

# [edge_runtime.secrets]
# secret_key = "env(SECRET_VALUE)"

[analytics]
enabled = true
port = 54327
# Configure one of the supported backends: `postgres`, `bigquery`.
backend = "postgres"

# Experimental features may be deprecated any time
[experimental]
# Configures Postgres storage engine to use OrioleDB (S3)
orioledb_version = ""
# Configures S3 bucket URL, eg. <bucket_name>.s3-<region>.amazonaws.com
s3_host = "env(S3_HOST)"
# Configures S3 bucket region, eg. us-east-1
s3_region = "env(S3_REGION)"
# Configures AWS_ACCESS_KEY_ID for S3 bucket
s3_access_key = "env(S3_ACCESS_KEY)"
# Configures AWS_SECRET_ACCESS_KEY for S3 bucket
s3_secret_key = "env(S3_SECRET_KEY)"

[functions.api-core]
enabled = true
verify_jwt = true
import_map = "./functions/api-core/deno.json"
# Uncomment to specify a custom file path to the entrypoint.
# Supported file extensions are: .ts, .js, .mjs, .jsx, .tsx
entrypoint = "./functions/api-core/index.ts"
# Specifies static files to be bundled with the function. Supports glob patterns.
# For example, if you want to serve static HTML pages in your function:
# static_files = [ "./functions/api-core/*.html" ]
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": [
        "./*"
      ]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  // å¤‰æ›´å¾Œ
  "exclude": [
    "node_modules",
    "supabase"
  ]
}
</file>

<file path="app/dashboard/team-building/page.tsx">
import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import Link from "next/link";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { CheckCircle2, Circle, ArrowRight, TrendingUp, Mail, Users, Building2, User } from "lucide-react";

export default async function TeamBuildingPage() {
  const supabase = await createClient();
  const { data: { user } } = await supabase.auth.getUser();

  if (!user) {
    redirect("/login");
  }

  // ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ãƒŠãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const { data: employee } = await supabase
    .from("employees")
    .select("*, tenants(name)")
    .eq("id", user.id)
    .single();

  const tenantName = employee?.tenants?.name || "Unknown Company";
  const userName = employee?.name || user.email || "Unknown User";

  const steps = [
    {
      id: 'offer-validator',
      step: 'Offer Validator', // æ—§: Step 1: è¨ºæ–­
      title: 'ã‚ªãƒ•ã‚¡ãƒ¼å¦¥å½“æ€§è¨ºæ–­', // æ—§: Offer Validator
      description: 'ã€Œãã®å¹´åæç¤ºã€è² ã‘æˆ¦ã«ãªã£ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿã€',
      detail: 'è·ç¨®ã¨åœ°åŸŸã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€AIãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®æ±‚äººç›¸å ´ã‚’åˆ†æã€‚ã‚ãªãŸã®æç¤ºæ¡ä»¶ãŒãƒ©ã‚¤ãƒãƒ«ä¼æ¥­ã¨æ¯”è¼ƒã—ã¦ã€Œå‹ã¦ã‚‹ã‚ªãƒ•ã‚¡ãƒ¼ã€ã‹ã©ã†ã‹ã‚’æ•°ç§’ã§åˆ¤å®šã—ã¾ã™ã€‚',
      status: 'ready',
      href: '/dashboard/team-building/offer-validator',
      color: 'blue',
      icon: TrendingUp,
      statusIcon: Circle,
    },
    {
      id: 'first-recruiter',
      step: 'First Recruiter', // æ—§: Step 2: ç²å¾—
      title: 'æ¡ç”¨ãƒ¡ãƒ¼ãƒ«è‡ªå‹•ç”Ÿæˆ', // æ—§: First Recruiter
      description: 'ã€Œæ¬²ã—ã„äººæã«ã€"åˆºã•ã‚‹"æ‰‹ç´™ã‚’ã€‚ã€',
      detail: 'å€™è£œè€…ã®çµŒæ­´æ›¸ã‚’ã‚³ãƒ”ãƒšã™ã‚‹ã ã‘ã€‚AIãŒãã®äººã®å¼·ã¿ã¨è‡ªç¤¾ã®é­…åŠ›ã‚’çµã³ã¤ã‘ã€æ€ã‚ãšè¿”ä¿¡ã—ãŸããªã‚‹ã€Œ1to1ã®ã‚¹ã‚«ã‚¦ãƒˆæ–‡é¢ã€ã‚’ã‚ãªãŸã«ä»£ã‚ã£ã¦åŸ·ç­†ã—ã¾ã™ã€‚',
      status: 'completed',
      href: '/dashboard/team-building/first-recruiter',
      color: 'orange',
      icon: Mail,
      statusIcon: CheckCircle2,
    },
    {
      id: 'staff-booster',
      step: 'Staff Booster', // æ—§: Step 3: å¢—å¼·
      title: 'ç¤¾å“¡å¢—åŠ›åŒ– & ãƒªãƒ•ã‚¡ãƒ©ãƒ«æ”¯æ´', // æ—§: Staff Booster
      description: 'ã€Œç¤¾å“¡ã®ä»•äº‹ã‚’æ¸›ã‚‰ã—ã€ä»²é–“ã‚’å¢—ã‚„ãã†ã€‚ã€',
      detail: 'å¿™ã—ã„ç¤¾å“¡ã®ã€Œæ—¥ç¨‹èª¿æ•´ã€ã‚„ã€Œãƒ¡ãƒ¼ãƒ«ä½œæˆã€ã‚’AIãŒä»£è¡Œã—ã€æ¥­å‹™è² è·ã‚’è»½æ¸›ã€‚ç”Ÿã¾ã‚ŒãŸä½™è£•ã¨AIã®ã‚µãƒãƒ¼ãƒˆã§ã€å¿ƒç†çš„è² æ‹…ã‚¼ãƒ­ã®ã€Œè‡ªç„¶ãªãƒªãƒ•ã‚¡ãƒ©ãƒ«ç´¹ä»‹ã€ã‚’å®Ÿç¾ã—ã¾ã™ã€‚',
      status: 'pending',
      href: '/dashboard/team-building/staff-booster',
      color: 'emerald',
      icon: Users,
      statusIcon: Circle,
    }
  ];

  const getColorClasses = (color: string) => {
    switch (color) {
      case 'blue':
        return {
          bar: 'bg-blue-500',
          badge: 'bg-blue-50 text-blue-700 border-blue-200',
          icon: 'text-blue-600',
          hoverBorder: 'hover:border-blue-500/50',
        };
      case 'orange':
        return {
          bar: 'bg-orange-500',
          badge: 'bg-orange-50 text-orange-700 border-orange-200',
          icon: 'text-orange-600',
          hoverBorder: 'hover:border-orange-500/50',
        };
      case 'emerald':
        return {
          bar: 'bg-emerald-500',
          badge: 'bg-emerald-50 text-emerald-700 border-emerald-200',
          icon: 'text-emerald-600',
          hoverBorder: 'hover:border-emerald-500/50',
        };
      default:
        return {
          bar: 'bg-primary',
          badge: 'bg-primary/10 text-primary border-primary/20',
          icon: 'text-primary',
          hoverBorder: 'hover:border-primary/50',
        };
    }
  };

  return (
    <div className="mx-auto max-w-5xl space-y-8">
      {/* Navigation Header */}
      <div className="flex items-center gap-2 text-sm text-muted-foreground">
        <Link href="/dashboard" className="hover:text-primary transition-colors">
          Home
        </Link>
        <span>/</span>
        <span className="font-medium text-foreground">Team Building</span>
      </div>

      <div className="mb-8">
        <h1 className="text-3xl font-bold tracking-tight text-foreground">äººäº‹ãƒ»æ¡ç”¨æ”¯æ´</h1>
        <div className="flex items-center gap-4 text-muted-foreground mt-2 text-sm">
          <div className="flex items-center gap-1"><Building2 className="h-4 w-4" /> {tenantName}</div>
          <div className="flex items-center gap-1"><User className="h-4 w-4" /> {userName}</div>
        </div>
        <p className="text-muted-foreground mt-4">
          è¨ºæ–­ã‹ã‚‰æ¡ç”¨ã€å®šç€ã¾ã§ã€‚çµ„ç¹”ã‚’å¼·ãã™ã‚‹ãŸã‚ã®3ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã€‚
        </p>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        {steps.map((step) => {
          const colors = getColorClasses(step.color);
          const Icon = step.icon;
          const StatusIcon = step.statusIcon;

          return (
            <Link key={step.id} href={step.href} className="group block h-full">
              <Card className={`h-full border-2 transition-all duration-200 hover:shadow-md cursor-pointer relative overflow-hidden ${colors.hoverBorder}`}>
                <div className={`absolute top-0 left-0 w-1 h-full ${colors.bar}`} />
                <CardHeader>
                  <div className="flex items-center justify-between mb-2">
                    <Badge variant="outline" className={colors.badge}>
                      {step.step}
                    </Badge>
                    <StatusIcon className={`h-5 w-5 ${step.status === 'completed' ? 'text-green-500' : 'text-gray-300'}`} />
                  </div>
                  <CardTitle className="text-xl flex items-center gap-2">
                    <Icon className={`h-5 w-5 ${colors.icon}`} />
                    {step.title}
                  </CardTitle>
                  <CardDescription className="text-base font-medium text-foreground mt-2">
                    {step.description}
                  </CardDescription>
                </CardHeader>
                <CardContent>
                  <p className="text-sm text-muted-foreground leading-relaxed">
                    {step.detail}
                  </p>
                  <div className="mt-6 flex items-center text-sm font-medium text-primary opacity-0 -translate-x-2 transition-all group-hover:opacity-100 group-hover:translate-x-0">
                    è©³ç´°ã‚’è¦‹ã‚‹ <ArrowRight className="ml-1 h-4 w-4" />
                  </div>
                </CardContent>
              </Card>
            </Link>
          );
        })}
      </div>
    </div>
  );
}
</file>

<file path="app/login/page.tsx">
"use client";

import { login, signup } from "@/app/auth/actions";
import { Button } from "@/components/ui/button";
import {
    Card,
    CardContent,
    CardDescription,
    CardFooter,
    CardHeader,
    CardTitle,
} from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import Link from "next/link";
import { useActionState, Suspense } from "react";
import { Loader2 } from "lucide-react";

function LoginForm() {
    const [state, formAction, isPending] = useActionState(login, null);

    return (
        <Card className="w-[350px] shadow-lg">
            <CardHeader className="space-y-1">
                <CardTitle className="text-2xl font-bold text-center">ãƒ­ã‚°ã‚¤ãƒ³</CardTitle>
                <CardDescription className="text-center">
                    IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </CardDescription>
            </CardHeader>
            <form action={formAction}>
                {/* pb-6 ã‚’è¿½åŠ ã—ã¦ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ã¨ã®é–“éš”ã‚’åºƒã’ã¾ã—ãŸ */}
                <CardContent className="grid gap-4 pb-6">
                    <div className="grid gap-2">
                        <Label htmlFor="email">ãƒ­ã‚°ã‚¤ãƒ³ID (ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹)</Label>
                        <Input
                            id="email"
                            name="email"
                            type="email"
                            placeholder="name@example.com"
                            required
                        />
                    </div>
                    <div className="grid gap-2">
                        <div className="flex items-center justify-between">
                            <Label htmlFor="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</Label>
                        </div>
                        <Input
                            id="password"
                            name="password"
                            type="password"
                            required
                        />
                    </div>

                    {/* ä»•æ§˜æ›¸ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸã‚‰ã“ã“ã€ã¸ã®ãƒªãƒ³ã‚¯ */}
                    <div className="text-right">
                        <Link
                            href="/forgot-password"
                            className="text-sm text-muted-foreground hover:text-primary underline underline-offset-4"
                        >
                            ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸã‚‰ã“ã“
                        </Link>
                    </div>

                    {/* ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ */}
                    {state?.error && (
                        <p className="text-sm text-red-500 font-medium text-center bg-red-50 p-2 rounded border border-red-100">
                            {state.error}
                        </p>
                    )}
                </CardContent>

                {/* ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢: pt-2 ã‚’è¿½åŠ ã—ã¦ã•ã‚‰ã«å¾®èª¿æ•´ */}
                <CardFooter className="flex flex-col gap-3 pt-2">
                    {/* Primaryã‚«ãƒ©ãƒ¼ï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ï¼‰ã®ãƒœã‚¿ãƒ³ */}
                    <Button className="w-full font-bold" disabled={isPending}>
                        {isPending ? (
                            <>
                                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                                ãƒ­ã‚°ã‚¤ãƒ³ä¸­...
                            </>
                        ) : (
                            "ãƒ­ã‚°ã‚¤ãƒ³"
                        )}
                    </Button>

                    <Button formAction={signup} variant="ghost" className="w-full text-xs text-muted-foreground" disabled={isPending}>
                        æ–°è¦ç™»éŒ² (é–‹ç™ºç”¨)
                    </Button>
                </CardFooter>
            </form>
        </Card>
    );
}

export default function LoginPage() {
    return (
        <div className="flex h-screen items-center justify-center bg-gray-50">
            <Suspense>
                <LoginForm />
            </Suspense>
        </div>
    )
}
</file>

<file path="app/layout.tsx">
import type { Metadata } from "next";
import { Inter } from "next/font/google";
import "./globals.css";

const inter = Inter({
  subsets: ["latin"],
  variable: "--font-sans",
});

export const metadata: Metadata = {
  title: "äººäº‹dx | çµ„ç¹”ã‚’å¼·ãã™ã‚‹çµ±åˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ",
  description: "äººäº‹åŠ´å‹™ã®èª²é¡Œã‚’AIã§è§£æ±ºã™ã‚‹SaaSãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    // å¤‰æ›´å¾Œ (ã“ã‚Œã‚’è¿½åŠ )
    <html lang="ja" suppressHydrationWarning>
      <body className={`${inter.variable} antialiased`}>
        {children}
      </body>
    </html>
  );
}
</file>

<file path="app/page.tsx">
"use client";

import { login, signup } from "@/app/auth/actions";
import { Button } from "@/components/ui/button";
import {
  Card,
  CardContent,
  CardDescription,
  CardFooter,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import Link from "next/link";
import { useActionState, Suspense } from "react";
import { Loader2 } from "lucide-react";

function LoginForm() {
  const [state, formAction, isPending] = useActionState(login, null);

  return (
    <Card className="w-[350px] shadow-lg">
      <CardHeader className="space-y-1">
        <CardTitle className="text-2xl font-bold text-center">ãƒ­ã‚°ã‚¤ãƒ³</CardTitle>
        <CardDescription className="text-center">
          IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
        </CardDescription>
      </CardHeader>
      <form action={formAction}>
        <CardContent className="grid gap-4 pb-8">
          <div className="grid gap-2">
            <Label htmlFor="email">ãƒ­ã‚°ã‚¤ãƒ³ID (ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹)</Label>
            <Input
              id="email"
              name="email"
              type="email"
              placeholder="name@example.com"
              required
            />
          </div>
          <div className="grid gap-2">
            <div className="flex items-center justify-between">
              <Label htmlFor="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</Label>
            </div>
            <Input
              id="password"
              name="password"
              type="password"
              required
            />
          </div>

          <div className="text-right">
            <Link
              href="/forgot-password"
              className="text-sm text-muted-foreground hover:text-primary underline underline-offset-4"
            >
              ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸã‚‰ã“ã“
            </Link>
          </div>

          {state?.error && (
            <div className="mt-2 p-3 bg-red-50 border border-red-200 rounded-md">
              <p className="text-sm text-red-600 font-medium text-center">
                {state.error}
              </p>
            </div>
          )}
        </CardContent>

        <CardFooter className="flex flex-col gap-3">
          <Button className="w-full font-bold text-base h-11" disabled={isPending}>
            {isPending ? (
              <>
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                ãƒ­ã‚°ã‚¤ãƒ³ä¸­...
              </>
            ) : (
              "ãƒ­ã‚°ã‚¤ãƒ³"
            )}
          </Button>

          <Button formAction={signup} variant="ghost" className="w-full text-xs text-muted-foreground" disabled={isPending}>
            æ–°è¦ç™»éŒ² (é–‹ç™ºç”¨)
          </Button>
        </CardFooter>
      </form>
    </Card>
  );
}

export default function LoginPage() {
  return (
    <div className="flex h-screen items-center justify-center bg-gray-50">
      <Suspense>
        <LoginForm />
      </Suspense>
    </div>
  )
}
</file>

<file path="app/auth/actions.ts">
"use server";

import { revalidatePath } from "next/cache";
import { redirect } from "next/navigation";
import { createClient } from "@/utils/supabase/server";

export async function login(prevState: { error: string } | null, formData: FormData) {
    const supabase = await createClient();

    const email = formData.get("email") as string;
    const password = formData.get("password") as string;

    // 1. Supabase Authã§ãƒ­ã‚°ã‚¤ãƒ³
    const { error, data } = await supabase.auth.signInWithPassword({
        email,
        password,
    });

    if (error) {
        // èªè¨¼ã‚¨ãƒ©ãƒ¼
        return { error: "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚" };
    }

    if (!data.user) {
        return { error: "èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚" };
    }

    // 2. ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® Role (å½¹è·) ã‚’å–å¾—
    const { data: employee, error: empError } = await supabase
        .from("employees")
        .select("role")
        .eq("id", data.user.id)
        .single();

    if (empError || !employee) {
        // ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆãªã©ã®ã‚¨ãƒ©ãƒ¼æ™‚
        return { error: "ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚" };
    }

    revalidatePath("/", "layout");

    // 3. ä»•æ§˜æ›¸ã«åŸºã¥ãç”»é¢é·ç§»ã®åˆ†å²
    // ãƒãƒ¼ã‚¿ãƒ«ç”»é¢ã¸ä¸€å¾‹é·ç§» (æ¨©é™ã«ã‚ˆã‚‹åˆ†å²ã¯ãƒãƒ¼ã‚¿ãƒ«å´ã§åˆ¶å¾¡ã€ã¾ãŸã¯ãƒãƒ¼ã‚¿ãƒ«ã‹ã‚‰ã®å‹•ç·šã§åˆ¶å¾¡)
    redirect("/portal");
}

export async function signup(formData: FormData) {
    const supabase = await createClient();

    const email = formData.get("email") as string;
    const password = formData.get("password") as string;

    const { error } = await supabase.auth.signUp({
        email,
        password,
    });

    if (error) {
        return redirect("/login?error=" + encodeURIComponent("ç™»éŒ²å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " + error.message));
    }

    revalidatePath("/", "layout");
    redirect("/portal");
}

export async function logout() {
    const supabase = await createClient();
    await supabase.auth.signOut();
    revalidatePath("/", "layout");
    redirect("/login");
}
</file>

<file path="app/dashboard/_components/dashboard-nav.tsx">
import Link from "next/link";
import { Button } from "@/components/ui/button";
import {
    Home,
    Users,
    Workflow,
    Settings,
    Briefcase,
    ArrowLeft,
    UserPlus,
    Heart,
    GraduationCap,
    Bot,
    Headset,
    Megaphone,
    TrendingUp,
    Coins,
    Zap,
    ShieldCheck,
    LucideIcon,
} from "lucide-react";

interface DashboardNavProps {
    className?: string;
    onLinkClick?: () => void;
}

interface NavItem {
    title: string;
    url: string;
    icon: LucideIcon;
}

export function DashboardNav({ className, onLinkClick }: DashboardNavProps) {
    const navItems: NavItem[] = [
        {
            title: "Home",
            url: "/dashboard",
            icon: Home,
        },
        {
            title: "äººäº‹ãƒ»æ¡ç”¨æ”¯æ´",
            url: "/dashboard/team-building",
            icon: UserPlus,
        },
        {
            title: "çµ„ç¹”ã®å¥åº·åº¦æ¸¬å®šãƒ»æ—©æœŸå¯¾å¿œ",
            url: "/dashboard/well-being",
            icon: Heart,
        },
        {
            title: "äººæè‚²æˆãƒ»ãƒªã‚¹ã‚­ãƒªãƒ³ã‚°",
            url: "/dashboard/reskilling",
            icon: GraduationCap,
        },
        {
            title: "æ¥­å‹™è‡ªå‹•åŒ–ãƒ»ç”Ÿç”£æ€§å‘ä¸Š",
            url: "/dashboard/automation",
            icon: Bot,
        },
        {
            title: "é¡§å®¢å¯¾å¿œãƒ»å–¶æ¥­æ”¯æ´",
            url: "/dashboard/support",
            icon: Headset,
        },
        {
            title: "ç¤¾å†…å‘ã‘ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆ",
            url: "/dashboard/marketing",
            icon: Megaphone,
        },
        {
            title: "éœ€è¦äºˆæ¸¬ãƒ»åœ¨åº«ç®¡ç†",
            url: "/dashboard/forecast",
            icon: TrendingUp,
        },
        {
            title: "è³‡é‡‘ç¹°ã‚Šãƒ»çµŒå–¶æ”¯æ´",
            url: "/dashboard/finance",
            icon: Coins,
        },
        {
            title: "DXãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–æ¨é€²",
            url: "/dashboard/dx",
            icon: Zap,
        },
        {
            title: "ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒªã‚¹ã‚¯ç®¡ç†",
            url: "/dashboard/security",
            icon: ShieldCheck,
        },

        {
            title: "Employees",
            url: "/dashboard/employees",
            icon: Users,
        },
        {
            title: "Workflows",
            url: "/dashboard/workflows",
            icon: Workflow,
        },
        {
            title: "Settings",
            url: "/dashboard/settings",
            icon: Settings,
        },
    ];

    return (
        <nav className={`space-y-1 p-4 ${className}`}>
            {navItems.map((item) => (
                <Button
                    key={item.url}
                    variant="ghost"
                    className="w-full justify-start gap-2 text-muted-foreground hover:text-primary"
                    asChild
                    onClick={onLinkClick}
                >
                    <Link href={item.url}>
                        <item.icon className="h-4 w-4" />
                        {item.title}
                    </Link>
                </Button>
            ))}

            <div className="my-2 border-t" />

            <Button variant="ghost" className="w-full justify-start gap-2 text-muted-foreground hover:text-primary" asChild onClick={onLinkClick}>
                <Link href="/portal">
                    <ArrowLeft className="h-4 w-4" />
                    ãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹
                </Link>
            </Button>
        </nav>
    );
}
</file>

<file path="app/portal/page.tsx">
import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import {
    Card,
    CardContent,
    CardDescription,
    CardHeader,
    CardTitle,
} from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Users, Heart, Briefcase, Zap, Settings, LogOut, ArrowRight, Building2, User } from "lucide-react";
import Link from "next/link";
import { cn } from "@/lib/utils";
import { logout } from "@/app/auth/actions";

import { Russo_One } from "next/font/google";

const logoFont = Russo_One({ weight: "400", subsets: ["latin"] });

export default async function PortalPage() {
    const supabase = await createClient();

    // 1. èªè¨¼ãƒã‚§ãƒƒã‚¯
    const {
        data: { user },
        error: authError,
    } = await supabase.auth.getUser();

    if (authError || !user) {
        redirect("/login");
    }

    // 2. æ¨©é™ãƒã‚§ãƒƒã‚¯ (employeesãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰Roleã¨Tenantæƒ…å ±ã‚’å–å¾—)
    const { data: employee, error: empError } = await supabase
        .from("employees")
        .select("*, tenants(name)")
        .eq("id", user.id)
        .single();

    const isAdminOrManager = employee && employee.role !== "employee";
    const companyName = employee?.tenants?.name || "Unknown Company";
    const userName = employee?.name || user.email || "Unknown User";

    // ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿å®šç¾©
    const services = [
        {
            title: "å¥åº·çµŒå–¶",
            description: "åŠ´å‹™ãƒªã‚¹ã‚¯æ¤œçŸ¥ãƒ»ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹ Agentã€‚å¾“æ¥­å“¡ã®å¿ƒèº«ã®çŠ¶æ…‹ã‚’ç¶™ç¶šçš„ã«ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã—ã€æ—©æœŸã®ã‚¢ãƒ©ãƒ¼ãƒˆç™ºä¿¡ã‚„ã‚±ã‚¢ãƒ—ãƒ©ãƒ³ã®ææ¡ˆã‚’è¡Œã„ã¾ã™ã€‚",
            badge: "Well-Being",
            icon: Heart,
            color: "text-rose-600",
            borderColor: "border-l-rose-500",
            hoverBorderColor: "hover:border-rose-500",
            badgeVariant: "bg-rose-50 text-rose-600 hover:bg-rose-50 border-none",
        },
        {
            title: "æ¥­å‹™æ”¯æ´",
            description: "å…¥ç¤¾ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚° & SOPåŒ– Agentã€‚ç…©é›‘ãªå…¥ç¤¾æ‰‹ç¶šãã®è‡ªå‹•åŒ–ã‚„ã€æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹ã®æ¨™æº–åŒ–ãƒ»ãƒãƒ‹ãƒ¥ã‚¢ãƒ«åŒ–ã‚’æ”¯æ´ã—ã¾ã™ã€‚",
            badge: "Work Support",
            icon: Briefcase,
            color: "text-blue-600",
            borderColor: "border-l-blue-500",
            hoverBorderColor: "hover:border-blue-500",
            badgeVariant: "bg-blue-50 text-blue-600 hover:bg-blue-50 border-none",
        },
        {
            title: "ãƒãƒ¼ãƒ ãƒ“ãƒ«ãƒ‡ã‚£ãƒ³ã‚°",
            description: "æ¡ç”¨ã‚¹ã‚«ã‚¦ãƒˆç‰¹åŒ–å‹ Agentã€‚çµ„ç¹”ã®ã‚«ãƒ«ãƒãƒ£ãƒ¼ã«ãƒãƒƒãƒã—ãŸäººæã®ç™ºæ˜ã‹ã‚‰ã€ãƒãƒ¼ãƒ ç·¨æˆã®æœ€é©åŒ–ã¾ã§ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚",
            badge: "Team Building",
            icon: Users,
            color: "text-green-600",
            borderColor: "border-l-green-500",
            hoverBorderColor: "hover:border-green-500",
            badgeVariant: "bg-green-50 text-green-600 hover:bg-green-50 border-none",
        },
        {
            title: "ç”Ÿç”£æ€§å‘ä¸Š",
            description: "æ¥­å‹™åŠ¹ç‡åŒ– Agentã€‚æ—¥å¸¸ã®å®šå‹æ¥­å‹™ã‚’AIãŒä»£è¡Œãƒ»åŠ¹ç‡åŒ–ã—ã€å¾“æ¥­å“¡ãŒã‚ˆã‚Šå‰µé€ çš„ãªæ¥­å‹™ã«é›†ä¸­ã§ãã‚‹ç’°å¢ƒã‚’æ•´ãˆã¾ã™ã€‚",
            badge: "Work Efficiency",
            icon: Zap,
            color: "text-orange-600",
            borderColor: "border-l-orange-500",
            hoverBorderColor: "hover:border-orange-500",
            badgeVariant: "bg-orange-50 text-orange-600 hover:bg-orange-50 border-none",
        },
    ];

    return (
        <div className="min-h-screen bg-gray-50/50">
            {/* Header */}
            <header className="bg-white border-b sticky top-0 z-10 w-full shadow-sm">
                <div className="container mx-auto px-6 h-16 flex items-center justify-between">
                    <div>
                        <span className={`${logoFont.className} text-3xl md:text-4xl bg-gradient-to-r from-orange-500 to-red-600 bg-clip-text text-transparent drop-shadow-sm`}>
                            HR-dx
                        </span>
                    </div>

                    <div className="flex items-center gap-2">
                        <form action={logout}>
                            <Button variant="outline" size="sm" className="gap-2 h-9">
                                <LogOut className="h-4 w-4" />
                                ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
                            </Button>
                        </form>

                        {isAdminOrManager && (
                            <Button asChild variant="default" size="sm" className="gap-2 h-9 bg-gray-900 hover:bg-gray-800 text-white">
                                <Link href="/dashboard/employees">
                                    <Settings className="h-4 w-4" />
                                    ç®¡ç†ç”»é¢ã¸
                                </Link>
                            </Button>
                        )}
                    </div>
                </div>
            </header>

            {/* Main Content */}
            <main className="container mx-auto px-6 py-8">
                {/* Title Section */}
                <div className="mb-10 text-center md:text-left">
                    <h1 className="text-3xl font-bold tracking-tight text-gray-900">
                        äººäº‹DX ãƒãƒ¼ã‚¿ãƒ«
                    </h1>
                    <p className="text-muted-foreground mt-2 text-lg">
                        çµ„ç¹”ã‚’å¼·ãã™ã‚‹ãŸã‚ã®çµ±åˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
                    </p>

                    {/* User Info Display */}
                    <div className="text-sm text-muted-foreground flex items-center justify-center md:justify-start gap-4 mt-4">
                        <div className="flex items-center gap-1">
                            <Building2 className="h-4 w-4" />
                            <span>{companyName}</span>
                        </div>
                        <div className="text-gray-300">|</div>
                        <div className="flex items-center gap-1">
                            <User className="h-4 w-4" />
                            <span>{userName}</span>
                        </div>
                    </div>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-6xl mx-auto">
                    {services.map((service) => (
                        <Card
                            key={service.title}
                            className={cn(
                                "group relative shadow-sm hover:shadow-md transition-all duration-300 cursor-pointer bg-white overflow-hidden",
                                // Border styles: default left border, hover full border
                                "border-0 border-l-4 border-solid",
                                // On hover, keep left border width (and color if not overridden), and add border to other sides
                                // Note: hover:border adds border-width: 1px to all sides.
                                "hover:border",
                                service.borderColor,
                                service.hoverBorderColor
                            )}
                        >
                            <CardHeader className="pb-3 md:pb-4 space-y-4">
                                <Badge
                                    className={cn(
                                        "rounded-full px-3 py-1 text-xs font-medium w-fit shadow-none",
                                        service.badgeVariant
                                    )}
                                >
                                    {service.badge}
                                </Badge>

                                <div className="flex items-start justify-between">
                                    <CardTitle className="text-xl font-bold text-gray-900">
                                        {service.title}
                                    </CardTitle>
                                    <div className={cn("p-2 rounded-lg bg-gray-50 group-hover:bg-gray-100 transition-colors", service.color)}>
                                        <service.icon className="h-6 w-6" />
                                    </div>
                                </div>
                            </CardHeader>

                            <CardContent>
                                <CardDescription className="text-sm text-muted-foreground leading-relaxed line-clamp-3">
                                    {service.description}
                                </CardDescription>

                                {/* Reveal Text */}
                                <div className={cn(
                                    "mt-4 flex items-center font-medium text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300",
                                    service.color
                                )}>
                                    ã‚µãƒ¼ãƒ“ã‚¹ã¸ç§»å‹• <ArrowRight className="ml-2 h-4 w-4" />
                                </div>
                            </CardContent>
                        </Card>
                    ))}
                </div>
            </main>
        </div>
    );
}
</file>

</files>
